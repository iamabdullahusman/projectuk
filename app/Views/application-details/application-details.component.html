<ng-template #applicationDetailModal let-modal>
  <div class="modal-header" *ngIf="application">
    <div class="d-flex w-100 justify-content-between">
      <div class="d-flex fsize-1 fw-bold">
        <div class="lh-28">
          <span
            class="fa fa-angle-left fsize-3 me-2 pointer"
            (click)="DrawerSizeChange(1)"
            *ngIf="drawerWidth < 100"
          ></span>

          <span
            class="fa fa-angle-right fsize-3 me-2 pointer"
            (click)="DrawerSizeChange(0)"
            *ngIf="drawerWidth > 60"
          ></span>

          Regional manager:
        </div>


        <!-- Abdullah's Code -->
        <div class="d-inline-block" ngbDropdown style="line-height: normal">
          <button
            type="button"
            ngbDropdownToggle
            class="mb-1 me-2 btn btn-outline-link title-button py-0 px-1"
            *ngIf="application.isAssignedToRegionalManager"
          >
            {{ application.regionalManagerDetail.fullName }}
          </button>
          <button
            type="button"
            ngbDropdownToggle
            class="mb-2 me-2 btn btn-outline-link link-title font-size-sm"
            *ngIf="!application.isAssignedToRegionalManager"
          >
            Select Regional Manager
          </button>
          <div ngbDropdownMenu class="header-dropdown">
            <button
              class="dropdown-item"
              *ngFor="let rm of RMs"
              (click)="changeRM(application.applicationId, rm.userId)"
            >
              {{ rm.fullName }}
            </button>
          </div>
        </div>

        <!-- change div's with Abdullah's Code -->
        <!-- <div class="d-inline-block" ngbDropdown style="line-height: normal">
          <button
            type="button"
            ngbDropdownToggle
            class="mb-1 me-2 btn btn-outline-link title-button py-0 px-1"
            *ngIf="application.isAssignedToRegionalManager"
          >
            {{ application.regionalManagerDetail.fullName }}
          </button>
          <button
            type="button"
            ngbDropdownToggle
            class="mb-2 me-2 btn btn-outline-link link-title font-size-sm"
            *ngIf="!application.isAssignedToRegionalManager"
          >
            Select Regional Manager
          </button>
          <div ngbDropdownMenu class="header-dropdown">
            <button
              class="dropdown-item"
              *ngFor="let rm of RMs"
              (click)="changeRM(application.applicationId, rm.userId)"
            >
              {{ rm.fullName }}
            </button>
          </div>
        </div>  -->
      
      
      

      </div>
      <div class="fw-bold">
        Agent :
        <div class="d-inline-block" ngbDropdown>
          <button
            type="button"
            ngbDropdownToggle
            class="mb-1 me-2 btn btn-outline-link link-title title-button py-0 px-1"
            *ngIf="!isEmptyOrWhitespace(application.agentDetail?.fullName)"
          >
          {{ application.agentDetail?.fullName }}
          </button>

          
          <button
            type="button"
            ngbDropdownToggle
            class="mb-2 me-2 btn btn-outline-link link-title"
            *ngIf="isEmptyOrWhitespace(application.agentDetail?.fullName)"
          >
            <!-- Select Agent -->

            {{ selectedAgentName || 'Select Agent' }}
          </button>
       



          
          <div ngbDropdownMenu class="header-dropdown">
            <input
              type="text"
              class="ms-2 form-control search-width"
              (keyup)="searchManager($event)"
            />
            <h6 *ngIf="agents.length > 0"></h6>
            <button
              class="dropdown-item"
              *ngFor="let changeagent of agents"
              (click)="
                ChangeAgnetData(application.applicationId, changeagent.userId , changeagent.fullName)
              "
            >
              {{ changeagent.userName }}
            </button>
          </div>
        </div>
      </div>
      <div class="fw-bold">
        Manage by :
        <div class="d-inline-block" ngbDropdown>
          <button
            type="button"
            ngbDropdownToggle
            class="mb-1 me-2 btn btn-outline-link link-title title-button py-0 px-1"
            *ngIf="application.managedata.fullName"
          >
            {{ application.managedata.fullName }}
          </button>
          <button
            type="button"
            ngbDropdownToggle
            class="mb-2 me-2 btn btn-outline-link link-title"
            *ngIf="!application.managedata.fullName"
          >
            Select Manager
          </button>
          <div ngbDropdownMenu class="header-dropdown">
            <input
              type="text"
              class="ms-2 form-control search-width"
              (keyup)="searchManager($event)"
            />
            <h6 *ngIf="admins.length > 0"></h6>
            <button
              class="dropdown-item"
              *ngFor="let changeadmins of admins"
              (click)="
                ChangeManage(application.applicationId, changeadmins.userId)
              "
            >
              {{ changeadmins.userName }}
            </button>
            <h6 *ngIf="subadmins.length > 0"></h6>
            <button
              class="dropdown-item"
              *ngFor="let changesub of subadmins"
              (click)="
                ChangeManage(application.applicationId, changesub.userId)
              "
            >
              {{ changesub.userName }}
            </button>
          </div>
        </div>
      </div>
      <div class="lh-28">
        <span
          class="btn btn-success edit-btn"
          (click)="editApplication(application.applicationId)"
          >Edit</span
        >
      </div>
    </div>
    <button
      type="button"
      class="close btn"
      aria-label="Close"
      (click)="MainCloseModel()"
    >
      <span aria-hidden="true">×</span>
    </button>
  </div>
  <div class="modal-body p-0" *ngIf="application">
    <div class="p-3 personal-details">
      <div class="d-flex justify-content-between mb-2">
        <div class="d-flex">
          <i class="fa fa-user text-primary name-personal-icon me-2"></i>
          <div class="name-personal-details text-capitalize fw-600">
            {{ application.lastName }} {{ application.firstName }}
          </div>
         
        </div>
        <div class="d-flex">
          <div class="me-1 lh-personal-details">Stage :</div>
          <div
            *ngIf="
              NochangeStatus(
                application.applicationStatus,
                application.applicationStage
              )
            "
          >
            <button
              type="button"
              class="mb-2 me-2 btn btn-outline-primary px-2 py-1 text-uppercase"
            >
              <!-- In-Progress  -->
              {{ application.applicationStatusName }}
            </button>
          </div>
          <div
            class="d-inline-block"
            ngbDropdown
            *ngIf="
              !NochangeStatus(
                application.applicationStatus,
                application.applicationStage
              )
            "
          >
            <button
              type="button"
              ngbDropdownToggle
              class="mb-2 me-2 btn btn-outline-primary px-2 py-1 text-uppercase"
            >
              {{ application.applicationStatusName }}
            </button>
            <div ngbDropdownMenu>
              <ng-container *ngFor="let stage of applicationStages">
                <button
                  class="dropdown-item"
                  *ngIf="stage.stageName != 'Received'"
                  (click)="
                    changeApplicationStatus(
                      application.applicationId,
                      stage.stageId
                    )
                  "
                >
                  {{ stage.stageName }}
                </button>
              </ng-container>
            </div>
          </div>
        </div>
      </div>
      <div class="d-flex fw-bold">
      <div class="d-flex align-items-center me-3">
        <i class="fa fa-hashtag  text-primary me-2"></i>
        <span class="text-muted font-weight-bold">Application Id: {{ application.applicationId }}</span>
      </div></div>
      <div class="d-flex justify-content-between mb-1">
        <div class="d-flex">
          <i class="pe-7s-call me-1 text-primary field-personal-icon me-2"></i>
          <div class="me-3 field-personal-details text-capitalize">
            {{ application.phoneNo }}
          </div>
          <i
            class="pe-7s-mail me-1 text-primary field-personal-icon me-2 mail-icon"
          ></i>
          <div class="field-personal-details">{{ application.email }}</div>
        </div>
        <div class="d-flex fsize-1">
          <div *ngIf="application.applicationStage > 0" class="me-1">
            STEPS :
          </div>
          <div *ngIf="application.applicationStage > 0" class="fw-bold">
            {{ (application.applicationStage < 4) ? application.applicationStage : 3 }}/3
          </div>
        </div>
      </div>
      <div class="d-flex justify-content-between">
        <div class="d-flex">
          <i
            class="pe-7s-map-marker me-1 text-primary field-personal-icon text"
          ></i>
          <div class="field-personal-details text-capitalize">
            {{ application.adress }}
          </div>
        </div>
      </div>
    </div>
    <mat-tab-group
      [selectedIndex]="selectedindex"
      (selectedTabChange)="setmetgroupindex($event)"
    >
      <mat-tab label="Application Details">
        <div class="modal-tab-scroll">
          <div
            class="accordion accordion-flush"
            id="accordionFlushExample"
            (click)="setmetgroupindex(0)"
          >
            <div class="accordion-item">
              <h2 class="accordion-header" id="information">
                <button
                  class="accordion-button fw-bold"
                  type="button"
                  data-bs-toggle="collapse"
                  data-bs-target="#information-details"
                  aria-expanded="false"
                  aria-controls="information-details"
                >
                  Information
                </button>
              </h2>
              <div
                id="information-details"
                class="accordion-collapse collapse show"
                aria-labelledby="information"
                data-bs-parent="#accordionFlushExample"
              >
                <div class="modal-tab-scroll">
                  <div class="mt-4 mx-4 text-end">
                    <input
                      type="button"
                      class="btn btn-primary"
                      *ngIf="application.applicationStatus == 3"
                      (click)="approveApplication()"
                      value="Approve Application"
                    />
                  </div>
                  <div class="row mx-0 mt-4 mx-2">
                    <div class="col-md-8 mb-3">
                      <div class="row">
                        <div class="col-md-5 mb-2 mt-2">
                          <span> Student All Mail send in this Role</span>
                        </div>
                        <div class="col-md-7 mb-3">
                          <ng-select
                            bindLabel="Select Role"
                            [(ngModel)]="application.mailSendRoleId"
                            (change)="ChangeRole($event)"
                            placeholder="Select Role"
                            [searchable]="true"
                            [clearable]="false"
                          >
                            <ng-option
                              [value]="Roles.roleIds"
                              [disabled]="Roles.disabled"
                              *ngFor="let Roles of roleList"
                            >
                              {{ Roles.roleName }}
                            </ng-option>
                          </ng-select>
                        </div>
                      </div>
                    </div>
                    <div class="col-md-4 mb-3"></div>
                    <hr />
                    <div class="col-md-4 mb-3">
                      <div class="fw-600 text-capitalize">
                        <div class="d-inline-block" ngbDropdown>
                          <button
                            type="button"
                            ngbDropdownToggle
                            class="mb-0 btn btn-outline-link title-button py-0 px-1"
                            *ngIf="application.intakeData.intakeName"
                          >
                            {{ application.intakeData.intakeName }}
                            {{
                              application.intakeData.startDate | date : " YYYY"
                            }}
                          </button>
                          <button
                            type="button"
                            ngbDropdownToggle
                            class="mb-1 me-2 btn btn-outline-link link-title"
                            *ngIf="!application.intakeData.intakeName"
                          >
                            Select Intake
                          </button>
                          <div ngbDropdownMenu>
                            <button
                              class="dropdown-item"
                              *ngFor="let intakerm of applicationIntakes"
                              (click)="
                                ChangeIntake(
                                  application.applicationId,
                                  intakerm.intakeId
                                )
                              "
                            >
                              {{ intakerm.intakeName
                              }}{{ intakerm.startDate | date : " YYYY" }}
                            </button>
                          </div>
                        </div>
                      </div>
                      <div class="text-muted">Intake applied for</div>
                    </div>
                    <div class="col-md-4 mb-3">
                      <div
                        class="fw-600 text-nowrap text-capitalize"
                        *ngIf="application.course"
                      >
                        {{ application.course.courseName }}
                      </div>
                      <div
                        class="fw-600 text-nowrap text-capitalize"
                        *ngIf="!application.course"
                      >
                        - - - - -
                      </div>
                      <div class="text-muted">Course</div>
                    </div>
                    <div class="col-md-4 mb-3 d-flex justify-content-between">
                      <div>
                        <div
                          class="fw-600 text-capitalize"
                          *ngIf="application.campusData"
                        >
                          {{ application.campusData.campusName }}
                        </div>
                        <div
                          class="fw-600 text-capitalize"
                          *ngIf="!application.campusData"
                        >
                          - - - - -
                        </div>
                        <div class="text-muted">Study Location</div>
                      </div>
                      <div
                        (click)="
                          InquiryLinkUnLink(
                            application.applicationId,
                            application.inquiryId
                          )
                        "
                      >
                        <div *ngIf="application.inquiryId < 1">
                          <button class="btn btn-primary">Link</button>
                        </div>
                        <div *ngIf="application.inquiryId > 0">
                          <button class="btn btn-primary">Unlink</button>
                        </div>
                      </div>
                    </div>
                    <div class="col-md-4 mb-3">
                      <div
                        class="fw-600 text-capitalize"
                        *ngIf="application.dateOfBirth"
                      >
                        {{ application.dateOfBirth | date : "dd/MM/yyyy" }}
                      </div>
                      <div
                        class="fw-600 text-capitalize"
                        *ngIf="!application.dateOfBirth"
                      >
                        - - - - -
                      </div>
                      <div class="text-muted">Date of Birth</div>
                    </div>
                    <div class="col-md-4 mb-3">
                      <div
                        class="fw-600 text-capitalize"
                        *ngIf="application.nationality"
                      >
                        {{ application.nationalityName }}
                      </div>
                      <div
                        class="fw-600 text-capitalize"
                        *ngIf="!application.nationality"
                      >
                        - - - - -
                      </div>
                      <div class="text-muted">Country of Nationality</div>
                    </div>
                    <div class="col-md-4 mb-3">
                      <div
                        class="fw-600 text-capitalize"
                        *ngIf="application.countryOfResident"
                      >
                        {{ application.countryOfResidentName }}
                      </div>
                      <div
                        class="fw-600 text-capitalize"
                        *ngIf="!application.countryOfResident"
                      >
                        - - - - -
                      </div>
                      <div class="text-muted">Country of Residence</div>
                    </div>

                    <hr />
                    <div class="col-md-4 mb-3">
                      <div
                        class="fw-600 text-capitalize"
                        *ngIf="application.parentFirstName"
                      >
                        <span class="stage-text" style="letter-spacing: 0px">{{
                          application.parentLastName
                        }}</span>
                        {{ application.parentFirstName }}
                      </div>
                      <div
                        class="fw-600 text-capitalize"
                        *ngIf="!application.parentFirstName"
                      >
                        - - - - -
                      </div>
                      <div class="text-muted">Parent/Guardian</div>
                    </div>
                    <div class="col-md-4 mb-3">
                      <div
                        class="fw-600 text-capitalize"
                        *ngIf="application.parentEmail"
                      >
                        {{ application.parentEmail }}
                      </div>
                      <div
                        class="fw-600 text-capitalize"
                        *ngIf="!application.parentEmail"
                      >
                        - - - - -
                      </div>

                      <div class="text-muted">Parent/Guardian Email</div>
                    </div>
                    <div class="col-md-4 mb-3">
                      <div
                        class="fw-600 text-capitalize"
                        *ngIf="application.parentPhoneNo"
                      >
                        {{ application.parentPhoneNo }}
                      </div>
                      <div
                        class="fw-600 text-capitalize"
                        *ngIf="!application.parentPhoneNo"
                      >
                        - - - - -
                      </div>

                      <div class="text-muted">Parent/Guardian Phone</div>
                    </div>
                    <hr />
                    <div class="col-md-4 mb-3">
                      <div
                        class="fw-600 text-capitalize"
                        *ngIf="application.lastSchoolQualification"
                      >
                        {{ application.lastSchoolQualification }}
                      </div>
                      <div
                        class="fw-600 text-capitalize"
                        *ngIf="!application.lastSchoolQualification"
                      >
                        - - - - -
                      </div>

                      <div class="text-muted">School Qualification</div>
                    </div>
                    <!-- <div class="col-md-8 mb-3">
                      <div
                        class="fw-600 text-capitalize"
                        *ngIf="application.secondarySchoolName"
                      >
                        {{ application.secondarySchoolName }}
                      </div>
                      <div
                        class="fw-600 text-capitalize"
                        *ngIf="!application.secondarySchoolName"
                      >
                        - - - - -
                      </div>

                      <div class="text-muted">Secondary School</div>
                    </div>
                    <div class="col-md-4 mb-3">
                      <div
                        class="fw-600 text-capitalize"
                        *ngIf="application.schoolCompletionYear"
                      >
                        {{ application.schoolCompletionYear }}
                      </div>
                      <div
                        class="fw-600 text-capitalize"
                        *ngIf="!application.schoolCompletionYear"
                      >
                        - - - - -
                      </div>

                      <div class="text-muted">School Completion In</div>
                    </div> -->
                    <div class="col-md-8 mb-3">
                      <div
                        class="fw-600 text-capitalize"
                        *ngIf="application.feePayByData"
                      >
                        {{ application.feePayByData.feePaidPerson }}
                      </div>
                      <div
                        class="fw-600 text-capitalize"
                        *ngIf="!application.feePayByData"
                      >
                        - - - - -
                      </div>

                      <div class="text-muted">Fee Payer</div>
                    </div>
                    <hr />
                    <div class="col-md-6 mb-3">
                      <div
                        class="fw-600 text-capitalize"
                        *ngIf="application.hasExistMedicalCondition"
                      >
                        Yes
                      </div>
                      <div
                        class="fw-600 text-capitalize"
                        *ngIf="!application.hasExistMedicalCondition"
                      >
                        No
                      </div>
                      <div class="text-muted">Medical</div>
                    </div>
                    <div class="col-md-6 mb-3">
                      <div
                        class="fw-600 text-capitalize"
                        *ngIf="application.medicalConditionDetail"
                      >
                        {{ application.medicalConditionDetail }}
                      </div>
                      <div
                        class="text-muted"
                        *ngIf="application.medicalConditionDetail"
                      >
                        Details
                      </div>
                    </div>
                    <div class="col-md-6 mb-3">
                      <div
                        class="fw-600 text-capitalize"
                        *ngIf="application.hasVisa"
                      >
                        Yes
                      </div>
                      <div
                        class="fw-600 text-capitalize"
                        *ngIf="!application.hasVisa"
                      >
                        No
                      </div>
                      <div class="text-muted">Previous/Current UK Visa</div>
                    </div>
                    <div class="col-md-6 mb-3">
                      <div
                        class="fw-600 text-capitalize"
                        *ngIf="application.visaTypeName"
                      >
                        {{ application.visaTypeName }}
                        <spam
                          class="fw-600 text-capitalize"
                          *ngIf="
                            application.visaTypeName == 'Other' ||
                            application.visaTypeName == 'other'
                          "
                        >
                          ( {{ application.visaTypeDetail }} )</spam
                        >
                      </div>
                      <div class="text-muted" *ngIf="application.visaTypeName">
                        Details
                      </div>
                    </div>
                  </div>
                </div>
                <div class="modal-footer">
                  <div class="d-flex justify-content-between w-100">
                    <div class="d-flex">
                      <div class="me-1 footer-title">Source:</div>
                      <div class="fw-bold">
                        {{ application.socialRefrenceName }}
                      </div>
                    </div>
                    <div class="d-flex">
                      <div class="me-1 footer-title">Created by :</div>
                      <div class="fw-bold">
                        {{ application.createdUser.fullName }}
                      </div>
                    </div>
                    <div class="d-flex">
                      <div class="me-1 footer-title">Last updated by:</div>
                      <div
                        class="text-capitalize fw-600"
                        *ngIf="application.updatedUser"
                      >
                        {{ application.updatedUser.fullName }}
                      </div>
                      <div
                        class="text-capitalize fw-600"
                        *ngIf="!application.updatedUser"
                      >
                        -----
                      </div>
                    </div>
                    <div class="d-flex">
                      <div class="me-1 footer-title">
                        {{
                          application.updatedDate | date : "HH:mm dd/MM/YYYY"
                        }}
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="accordion-item">
              <h2
                class="accordion-header"
                id="documentation"
                (click)="setmetgroupindex(1)"
              >
                <button
                  class="accordion-button fw-bold collapsed"
                  type="button"
                  data-bs-toggle="collapse"
                  data-bs-target="#documentation-details"
                  aria-expanded="false"
                  aria-controls="flush-collapseTwo"
                >
                  Documentation
                </button>
              </h2>
              <div
                id="documentation-details"
                class="accordion-collapse collapse"
                aria-labelledby="documentation"
                data-bs-parent="#accordionFlushExample"
              >
                <div class="accordion-body">
                  <div class="modal-tab-scroll">
                    <perfect-scrollbar [autoPropagation]="true">
                      <div class="mx-4 text-end">
                        <input
                          type="button"
                          (click)="DocReq()"
                          [disabled]="
                            application.applicationStatus == 2 ||
                            application.applicationStatus == 3
                          "
                          class="btn btn-primary"
                          value="Request Document"
                        />
                      </div>
                      <div class="row mt-4 mx-0">
                        <table class="align-middle mb-0 table">
                          <thead>
                            <tr>
                              <th class="text-left">Document Name</th>
                              <th class="text-left">Total Documents</th>
                              <th class="text-left">Status</th>
                              <th class="text-left">Requested On</th>
                              <th class="text-left">Uploaded On</th>

                              <th class="text-left">Operation Selection</th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr *ngFor="let Docnote of applicationDocument">
                              <td>
                                {{ Docnote.applicationDocName }}
                              </td>
                              <td>
                                {{ Docnote.count }}
                              </td>
                              <td
                                *ngIf="Docnote.applicationStatus == 1"
                                class="btn bg-primary rounded-pill"
                                style="
                                  height: 30px;
                                  padding-top: 4px;
                                  margin-top: 5px;
                                "
                              >
                                Requested
                              </td>
                              <td
                                *ngIf="Docnote.applicationStatus == 2"
                                class="btn bg-warning rounded-pill"
                                style="
                                  height: 30px;
                                  padding-top: 4px;
                                  margin-top: 5px;
                                "
                              >
                                Uploaded
                              </td>
                              <td
                                *ngIf="Docnote.applicationStatus == 3"
                                class="btn bg-success rounded-pill"
                                style="
                                  height: 30px;
                                  padding-top: 4px;
                                  margin-top: 5px;
                                "
                              >
                                Approved
                              </td>
                              <td
                                *ngIf="Docnote.applicationStatus == 4"
                                class="btn bg-danger rounded-pill"
                                style="
                                  height: 30px;
                                  padding-top: 4px;
                                  margin-top: 5px;
                                "
                              >
                                Rejected
                              </td>
                              <td
                                *ngIf="Docnote.applicationStatus == 5"
                                class="btn bg-info rounded-pill"
                                style="
                                  height: 30px;
                                  padding-top: 4px;
                                  margin-top: 5px;
                                "
                              >
                                ReUpload
                              </td>
                              <td
                                *ngIf="Docnote.applicationStatus == 6"
                                class="btn bg-success rounded-pill"
                                style="
                                  height: 30px;
                                  padding-top: 4px;
                                  margin-top: 5px;
                                "
                              >
                                Physical Approved
                              </td>
                              <td
                                *ngIf="Docnote.applicationStatus == 7"
                                class="btn bg-danger rounded-pill"
                                style="
                                  height: 30px;
                                  padding-top: 4px;
                                  margin-top: 5px;
                                "
                              >
                                Physical Rejected
                              </td>
                              <td>
                                {{ Docnote.requestedOn | date : "dd MMM ''yy" }}
                              </td>

                              <td>
                                {{ Docnote.updatedOn | date : "dd MMM ''yy" }}
                              </td>
                              <td class="text-left text-nowrap">
                                <button
                                  class="fa fa-upload btn-sm btn-warning me-2"
                                  (click)="
                                    DocumentUploadViewModel(
                                      DocumentUploadView,
                                      Docnote.docId
                                    )
                                  "
                                  title="Upload"
                                ></button>

                                <!-- <button class="btn-sm btn-success fa fa-download me-2 " title="Download"
                              (click)="downloadForm(Docnote.document)" *ngIf="Docnote.applicationStatus==3||Docnote.applicationStatus==2||Docnote.applicationStatus==4||Docnote.applicationStatus==5||Docnote.applicationStatus==6||Docnote.applicationStatus==7"></button>
                              -->
                                <button
                                  class="me-2 btn-sm btn-info fa fa-eye"
                                  (click)="
                                    OpenModel(
                                      DocumentUploadView1,
                                      Docnote.docId
                                    )
                                  "
                                  *ngIf="
                                    Docnote.applicationStatus == 3 ||
                                    Docnote.applicationStatus == 2 ||
                                    Docnote.applicationStatus == 4 ||
                                    Docnote.applicationStatus == 5 ||
                                    Docnote.applicationStatus == 6 ||
                                    Docnote.applicationStatus == 7
                                  "
                                ></button>

                                <!-- <button (click)="printPage(Docnote.document)" class="fa fa-print btn-sm" title="Print" *ngIf="Docnote.applicationStatus==3||Docnote.applicationStatus==2||Docnote.applicationStatus==4||Docnote.applicationStatus==5||Docnote.applicationStatus==6||Docnote.applicationStatus==7"></button> -->
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                    </perfect-scrollbar>
                  </div>
                </div>
              </div>
            </div>

            <div class="accordion-item">
              <h2
                class="accordion-header"
                id="offer"
                (click)="setmetgroupindex(4)"
              >
                <button
                  class="accordion-button fw-bold collapsed"
                  type="button"
                  data-bs-toggle="collapse"
                  data-bs-target="#offer-details"
                  aria-expanded="false"
                  aria-controls="offer-details"
                >
                  Offer
                </button>
              </h2>
              <div
                id="offer-details"
                class="accordion-collapse collapse"
                aria-labelledby="offer"
                data-bs-parent="#accordionFlushExample"
              >
                <div class="accordion-body">
                  <div class="mx-0 mt-3 ms-2" *ngIf="isSendButton">
                    <label class="fsize-2"
                      ><b>Want to send an offer, now?</b></label
                    ><br />
                    <button
                      type="button"
                      (click)="RedirectSaveOffer()"
                      class="btn btn-success mt-3"
                    >
                      Yes, Let's do it
                    </button>
                    <ng-container *ngIf="application.campusData">
                      <button
                        type="button"
                        *ngIf="application.campusData.campusId == 0"
                        (click)="ReadyToOffer()"
                        disabled
                        class="btn btn-primary ms-2 mt-3"
                      >
                        Ready To Offer 
                      </button>
                      <button
                        type="button"
                        *ngIf="application.campusData.campusId != 0"
                        (click)="ReadyToOffer()"
                        class="btn btn-primary ms-2 mt-3"
                        
                      >
                        Ready To Offer 
                      </button>
                    </ng-container>
                  </div>

                  <form
                    [formGroup]="sendOfferForm"
                    (ngSubmit)="SavePreviewOffer()"
                    *ngIf="isSaveSendButton"
                  >
                    <div class="row mx-0">
                      <div class="col-md-4">
                        <label class="mb-2"><b>New Intake</b> </label>
                        <ng-select
                          formControlName="intakeId"
                          (change)="getFee()"
                          bindLabel="intakeId"
                          placeholder="Select intake"
                          [searchable]="true"
                          [clearable]="false"
                        >
                          <ng-option
                            [value]="item.intakeId"
                            [disabled]="item.disabled"
                            *ngFor="let item of applicationIntakes"
                          >
                            {{ item.intakeName }}
                            {{ item.startDate | date : " YYYY" }}
                          </ng-option>
                        </ng-select>
                        <div
                          *ngIf="isFormSubmitted && fOffer['intakeId'].errors"
                        >
                          <span
                            *ngIf="
                              isFormSubmitted &&
                              fOffer['intakeId'].errors['required']
                            "
                            class="text-danger"
                            >Please choose Intake.</span
                          >
                        </div>
                      </div>
                      <div class="col-md-4">
                        <label class="mb-2"><b>New Course</b> </label>
                        <ng-select
                          formControlName="courseId"
                          (change)="getFee()"
                          bindLabel="courseId"
                          placeholder="Select Course"
                          [searchable]="true"
                          [clearable]="false"
                        >
                          <ng-option
                            [value]="item.courseId"
                            [disabled]="item.disabled"
                            *ngFor="let item of CourseData"
                          >
                            {{ item.courseName }}
                          </ng-option>
                        </ng-select>
                        <div
                          *ngIf="isFormSubmitted && fOffer['courseId'].errors"
                        >
                          <span
                            *ngIf="
                              isFormSubmitted &&
                              fOffer['courseId'].errors['required']
                            "
                            class="text-danger"
                            >Please choose course.</span
                          >
                        </div>
                      </div>
                      <div class="col-md-4">
                        <label class="mb-2"><b>New Campus</b> </label>
                        <ng-select
                          formControlName="campusId"
                          (change)="getFee()"
                          bindLabel="campusId"
                          placeholder="Select Campus"
                          [searchable]="true"
                          [clearable]="false"
                        >
                          <ng-option
                            [value]="item.campusId"
                            [disabled]="item.disabled"
                            *ngFor="let item of CampusData"
                          >
                            {{ item.campusName }}
                          </ng-option>
                        </ng-select>
                        <div
                          *ngIf="isFormSubmitted && fOffer['campusId'].errors"
                        >
                          <span
                            *ngIf="
                              isFormSubmitted &&
                              fOffer['campusId'].errors['required']
                            "
                            class="text-danger"
                            >Please choose campus.</span
                          >
                        </div>
                      </div>
                    </div>

                    <div class="row mx-0 mt-3">
                      <div class="col-md-4 mb-3">
                        <label class="mb-2"><b>Offer Type</b></label>
                        <div class="form-group">
                          <ng-select
                            formControlName="offerId"
                            bindLabel="offerName"
                            placeholder="Select offer"
                            [searchable]="true"
                            [clearable]="false"
                            (change)="ChangeOfferType($event)"
                          >
                            <ng-option
                              *ngFor="let FOffer of offerList"
                              [value]="FOffer.offerId"
                              [disabled]="FOffer.disabled"
                            >
                              {{ FOffer.offerId == 2 ? 'Unconditional Offer': FOffer.offerName  }}
                            </ng-option>
                          </ng-select>
                        </div>
                      </div>
                      <div class="col-md-4 mb-3" *ngIf="isShowdropCondition">
                        <br />
                        <div
                          class="btn btn-primary mt-2 me-2"
                          (click)="openConditionModal(true)"
                        >
                          Add Condition
                        </div>
                        <span *ngIf="totalCondition > 0"
                          >{{ totalCondition }} conditions selected</span
                        >
                      </div>
                      <div class="col-md-4 mb-3">
                        <label class="mb-2"
                          ><b>Additional Documents :</b></label
                        >
                        <div class="form-group">
                          <div class="ng-value" *ngFor="let item of items">
                            <span class="ng-value-label">
                              {{ item.docName }}</span
                            >
                            <span
                              class="ng-value-icon right"
                              (click)="clear(item)"
                              aria-hidden="true"
                              >×</span
                            >
                          </div>

                          <ng-select
                            class="show-full-doc-name"
                            formControlName="docIds"
                            bindLabel="docId"
                            placeholder="Select Additional document"
                            [(ngModel)]="aDDDoc"
                            (change)="
                              changeDocumentRequest($event, DocumentModal)
                            "
                            [searchable]="true"
                            [clearable]="false"
                            multiple="true"
                            style="width: 90% !important"
                          >
                            <ng-option
                              *ngFor="let FLDoc of GetRequestDocList"
                              [value]="FLDoc.docId"
                              [disabled]="FLDoc.disabled"
                            >
                              {{ FLDoc.docName }}
                            </ng-option>
                          </ng-select>
                        </div>
                      </div>
                    </div>
                    <div class="row mx-0">
                      <div class="col-md-4">
                        <label class="mb-2"><b>University</b> </label>
                        <ng-select
                          formControlName="UniversityId"
                          id="UniversityId"
                          (change)="changeUniversity()"
                          placeholder="Select University"
                        >
                          <!-- <option value>Select University</option> -->
                          <ng-option
                            *ngFor="let unisity of universitylist"
                            [value]="unisity.id"
                          >
                            {{ unisity.name }}
                          </ng-option>
                        </ng-select>
                        <!-- <div *ngIf="fOffer['UniversityId'].touched && fOffer['UniversityId'].errors">
                          <span *ngIf="fOffer['UniversityId'].touched && fOffer['UniversityId'].errors['required']" class="text-danger">Please
                            select University. </span>
                        </div> -->
                      </div>
                      <div class="col-md-4">
                        <label class="mb-2"><b>University Course</b> </label>
                        <ng-select
                          id="UniversityCourseId"
                          formControlName="UniversityCourseId"
                          (change)="changeCourse()"
                          placeholder="Select University course"
                        >
                          <ng-option
                            *ngFor="let unisity of Universitycourselist"
                            [value]="unisity.id"
                          >
                            {{ unisity.courseName }}
                          </ng-option>
                        </ng-select>
                        <!-- <div *ngIf="fOffer['UniversityCourseId'].touched && fOffer['UniversityCourseId'].errors">
                        <span *ngIf="fOffer['UniversityCourseId'].touched && fOffer['UniversityCourseId'].errors['required']" class="text-danger">Please
                            University Course.</span>
                        </div> -->
                      </div>
                      <div class="col-md-4">
                        <label class="mb-2"><b>Course Date</b> </label>
                        <select
                          class="form-control"
                          id="UniversityCourseDateId"
                          formControlName="UniversityCourseDateId"
                        >
                          <option value="0">
                            Select University Course Date
                          </option>
                          <!-- formControlName="UniversityId" -->
                          <option
                            *ngFor="let unisity of UniversityCourseDate"
                            value="{{ unisity.id }}"
                          >
                            {{ unisity.date }}
                          </option>
                        </select>
                        <!-- <div *ngIf="isFormSubmitted && fOffer['UniversityCourseDateId'].errors">
                          <span *ngIf="isFormSubmitted && fOffer['UniversityCourseDateId'].errors['required']" class="text-danger">Please
                            University Course Date.</span>
                        </div> -->
                      </div>
                    </div>
                    <div class="row mx-0 mt-3">
                      <div class="col-md-12 mb-3">
                        <label class="mb-2"
                          ><b>Progression Description</b>
                        </label>
                        <input
                          type="text"
                          value="{{ Progresioninfounicourse }}"
                          class="form-control"
                          id="Universityprogresstion"
                          readonly
                        />
                      </div>
                    </div>
                    <div class="row mx-0 mt-3">
                      <div class="col-md-4 mb-3">
                        <label class="mb-2"><b> Deposit Amount</b></label>
                        <div class="form-group input-group deposit-amount">
                          <div class="input-group-prepend">
                            <span class="input-group-text">£</span>
                          </div>
                          <input
                            type="number"
                            (change)="changeDepoInsatll()"
                            class="form-control"
                            placeholder="£ 0.00"
                            formControlName="depositeAmount"
                          />
                          <div
                            class="w-100"
                            *ngIf="
                              fOffer['depositeAmount'].touched &&
                              fOffer['depositeAmount'].errors
                            "
                          >
                            <span
                              *ngIf="
                                fOffer['depositeAmount'].errors['required']
                              "
                              class="text-danger"
                              >Please enter deposit amount.</span
                            >
                          </div>
                        </div>
                      </div>
                      <div class="col-md-4 mb-3">
                        <label class="mb-2"
                          ><b>Total Fee (Exclude deposit)</b></label
                        >
                        <div class="form-group input-group">
                          <div class="input-group-prepend">
                            <span class="input-group-text">£</span>
                          </div>
                          <input
                            type="number"
                            class="form-control"
                            placeholder="£ 0.00"
                            min="5200"
                            formControlName="totalFee"
                            readonly
                          />
                        </div>
                      </div>
                      <div class="col-md-4 mb-3">
                        <label class="mb-2"><b>No Of Installment</b></label>
                        <div class="form-group">
                          <input
                            type="number"
                            max="10"
                            class="form-control"
                            placeholder="No Of Installment"
                            formControlName="noOfIns"
                            (change)="addInstallment(true)"
                            disabled
                          />
                        </div>
                      </div>
                    </div>
                    <div class="row mx-0" formArrayName="installments">
                      <div
                        class="col-sm-4 mb-3"
                        *ngFor="
                          let installment of installmentControls;
                          let i = index
                        "
                        [formGroupName]="i"
                      >
                        <div class="row">
                          <div class="col-sm-12">
                            <label class="mb-2"
                              ><b>Installment {{ i + 1 }}</b></label
                            >
                            <div class="form-group input-group">
                              <div class="input-group-prepend">
                                <span class="input-group-text">£</span>
                              </div>
                              <input
                                type="number"
                                class="form-control"
                                placeholder="£ 0.00"
                                formControlName="installmentAmount"
                                (change)="changeInstallmentAmount()"
                              />
                              <span
                                *ngIf="
                                  installment.get('installmentAmount')
                                    .touched &&
                                  installment.get('installmentAmount').errors
                                "
                                class="text-danger"
                              >
                                <span
                                  *ngIf="
                                    installment.get('installmentAmount').errors[
                                      'required'
                                    ]
                                  "
                                >
                                  Please enter Installment Amount.</span
                                >
                                <span
                                  *ngIf="
                                    !installment.get('installmentAmount')
                                      .errors['required']
                                  "
                                >
                                  Total of installment amount and total fee must
                                  be same.</span
                                >
                              </span>
                            </div>
                          </div>
                          <div class="col-sm-12">
                            <label class="mb-2"
                              ><b>Due Date - Ins. {{ i + 1 }}</b></label
                            >
                            <div class="form-group">
                              <input
                                type="date"
                                class="form-control"
                                min="{{ minmunInstallment[i] }}"
                                formControlName="installmentDue"
                                (change)="setMinimumInstallmentValues(i)"
                                max="{{ setEndDate }}"
                              />
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="row mx-0 mt-3">
                      <div class="col-md-4 mb-3">
                        <!-- <mat-slide-toggle
                          class="example-margin"
                          [color]="color"
                          [checked]="isRequired"
                          (change)="IsVisaStudentForOffer()"
                          *ngIf="isVisaRequiredVisible"
                        >
                          Visa Required
                        </mat-slide-toggle> -->
                      </div>
                    </div>
                    <div class="mx-0 mt-3 ms-2">
                      <button
                        type="button"
                        *ngIf="!iscancelDtail"
                        class="btn btn-outline-danger ms-1"
                        (click)="resetOfferForm()"
                      >
                        Cancel
                      </button>
                      <button
                        type="button"
                        *ngIf="iscancelDtail"
                        class="btn btn-outline-danger ms-1"
                        (click)="redirectOfferDetail()"
                      >
                        Cancel
                      </button>
                      <button
                        type="submit"
                        class="btn btn-success ms-2"
                        *ngIf="!IsPriviousOffer"
                        disabled
                      >
                        Preview
                      </button>
                      <button
                        type="submit"
                        class="btn btn-success ms-2"
                        *ngIf="IsPriviousOffer"
                      >
                        Preview
                      </button>
                      <!-- Trigger button -->
                    </div>
                  </form>
                  <div *ngIf="!isSendButton && !isSaveSendButton">
                    <div class="mx-0 mt-3">
                      <div class="row">
                        <div class="col-md-4 mb-3">
                          <div class="fw-600 text-capitalize">
                            {{ OfferDetailModel.offerTypeName }}
                          </div>
                          <div class="text-muted">Type</div>
                        </div>
                        <div class="col-md-4 mb-3">
                          <span class="fw-600 text-capitalize"
                            >{{ OfferDetailModel?.documents[0]
                            }}<button
                              class="btn btn-link p-0"
                              (click)="setmetgroupindex(1)"
                              *ngIf="
                                OfferDetailModel.documentRequestedCount > 1
                              "
                            >
                              +
                              {{ OfferDetailModel.documentRequestedCount - 1 }}
                              More
                            </button>
                            <button
                              class="btn btn-link p-0"
                              (click)="setmetgroupindex(1)"
                              *ngIf="
                                OfferDetailModel?.documentRequestedCount == 0
                              "
                            >
                              Not Requested
                            </button></span
                          >
                          <div class="text-muted">
                            Requested Additional Document
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-4 mb-3">
                        <div class="fw-600 text-capitalize">
                          £ {{ OfferDetailModel.amount }}
                        </div>

                        <div class="text-muted">Deposit</div>
                      </div>
                      <div
                        class="col-md-4 mb-3"
                        *ngIf="OfferDetailModel.offerDate != null"
                      >
                        <div
                          class="fw-600 text-capitalize"
                          *ngIf="OfferDetailModel.offerStatus == 0"
                        >
                          {{
                            OfferDetailModel.offerResponceDate
                              | date : "dd/MM/YYYY"
                          }}
                        </div>
                        <div
                          class="fw-600 text-capitalize"
                          *ngIf="OfferDetailModel.offerStatus != 0"
                        >
                          {{ OfferDetailModel.offerDate | date : "dd/MM/YYYY" }}
                        </div>
                        <div
                          class="text-muted"
                          *ngIf="OfferDetailModel.offerStatus == 0"
                        >
                          Offer Date
                        </div>
                        <div
                          class="text-muted"
                          *ngIf="OfferDetailModel.offerStatus != 0"
                        >
                          Offer Send Date
                        </div>
                      </div>
                      <div
                        class="col-md-4 mb-3"
                        *ngIf="OfferDetailModel.offerStatus == 0"
                      >
                        <div
                          class="fsize-2 fw-600 text-capitalize mb-1 text-info"
                        >
                          Issued
                        </div>
                        <div class="text-muted">Status</div>
                      </div>

                      <div
                        class="row"
                        *ngIf="OfferDetailModel.offerStatus != 0"
                      >
                        <div class="col-md-4 mb-3">
                          <div
                            class="fsize-2 fw-600 text-capitalize mb-1 text-info"
                            *ngIf="OfferDetailModel.offerStatus == 0"
                          >
                            Issued
                          </div>
                          <div
                            class="fsize-2 fw-600 text-capitalize mb-1 text-danger"
                            *ngIf="OfferDetailModel.offerStatus == 1"
                          >
                            Offer Declined
                          </div>
                          <div
                            class="fsize-2 fw-600 text-capitalize mb-1 text-success"
                            *ngIf="OfferDetailModel.offerStatus == 2"
                          >
                            AcceptByStudent
                          </div>
                          <div
                            class="fsize-2 fw-600 text-capitalize mb-1 text-warning"
                            *ngIf="OfferDetailModel.offerStatus == 3"
                          >
                            Defer Requested
                          </div>
                          <div
                            class="fsize-2 fw-600 text-capitalize mb-1 text-warning"
                            *ngIf="OfferDetailModel.offerStatus == 14"
                          >
                            Ready To Offer
                          </div>
                          <div
                            class="fsize-2 fw-600 text-capitalize mb-1 text-warning"
                            *ngIf="OfferDetailModel.offerStatus == 15"
                          >
                            Ratify Offer
                          </div>
                          <div
                            class="fsize-2 fw-600 text-capitalize mb-1 text-warning"
                            *ngIf="OfferDetailModel.offerStatus == 13"
                          >
                            Student Accept Defere Offer
                          </div>
                          <div
                            class="fsize-2 fw-600 text-capitalize mb-1 text-warning"
                            *ngIf="OfferDetailModel.offerStatus == 4"
                          >
                            Withdraw
                          </div>
                          <div
                            class="fsize-2 fw-600 text-capitalize mb-1 text-success"
                            *ngIf="OfferDetailModel.offerStatus == 7"
                          >
                            Defer Offer Accepted
                          </div>
                          <div
                            class="fsize-2 fw-600 text-capitalize mb-1 text-danger"
                            *ngIf="OfferDetailModel.offerStatus == 8"
                          >
                            Defer Offer Rejected
                          </div>
                          <div
                            class="fsize-2 fw-600 text-capitalize mb-1 text-success"
                            *ngIf="OfferDetailModel.offerStatus == 9"
                          >
                            Continue With offer
                          </div>
                          <div
                            class="fsize-2 fw-600 text-capitalize mb-1 text-danger"
                            *ngIf="OfferDetailModel.offerStatus == 10"
                          >
                            User Rejected Offer
                          </div>
                          <div
                            class="fsize-2 fw-600 text-capitalize mb-1 text-danger"
                            *ngIf="OfferDetailModel.offerStatus == 5"
                          >
                            On-Hold
                          </div>
                          <div
                            class="fsize-2 fw-600 text-capitalize mb-1 text-warning"
                            *ngIf="OfferDetailModel.offerStatus == 6"
                          >
                            Expired
                          </div>
                          <div
                            class="fsize-2 fw-600 text-capitalize mb-1 text-danger"
                            *ngIf="OfferDetailModel.offerStatus == 11"
                          >
                            Canceled
                          </div>
                          <div
                            class="fsize-2 fw-600 text-capitalize mb-1 text-info"
                            *ngIf="OfferDetailModel.offerStatus == 12"
                          >
                            offer Requested
                          </div>

                          <div class="text-muted">Status</div>
                        </div>
                        <div
                          class="col-md-4 mb-3 ms-2"
                          *ngIf="OfferDetailModel.offerDate != null"
                        >
                          <div class="fw-600 text-capitalize">
                            {{
                              OfferDetailModel.offerResponceDate
                                | date : "dd/MM/YYYY"
                            }}
                          </div>
                          <div
                            class="text-muted"
                            *ngIf="OfferDetailModel.offerStatus == 0"
                          >
                            Offer Date
                          </div>
                          <div
                            class="text-muted"
                            *ngIf="OfferDetailModel.offerStatus == 2"
                          >
                            Offer Accepted Date
                          </div>
                          <div
                            class="text-muted"
                            *ngIf="OfferDetailModel.offerStatus == 3"
                          >
                            Offer Defer Date
                          </div>
                          <div
                            class="text-muted"
                            *ngIf="OfferDetailModel.offerStatus == 1"
                          >
                            Offer Declined Date
                          </div>
                          <div
                            class="text-muted"
                            *ngIf="OfferDetailModel.offerStatus == 5"
                          >
                            Offer On-Hold Date
                          </div>
                          <div
                            class="text-muted"
                            *ngIf="OfferDetailModel.offerStatus == 4"
                          >
                            Offer Withdraw Date
                          </div>
                          <div
                            class="text-muted"
                            *ngIf="OfferDetailModel.offerStatus == 6"
                          >
                            Offer Expire Date
                          </div>
                          <div
                            class="text-muted"
                            *ngIf="OfferDetailModel.offerStatus == 7"
                          >
                            Offer Defer Accepted Date
                          </div>
                          <div
                            class="text-muted"
                            *ngIf="OfferDetailModel.offerStatus == 8"
                          >
                            Offer Defer Rejected Date
                          </div>
                          <div
                            class="text-muted"
                            *ngIf="OfferDetailModel.offerStatus == 9"
                          >
                            Continue with Offer Date
                          </div>
                          <div
                            class="text-muted"
                            *ngIf="OfferDetailModel.offerStatus == 10"
                          >
                            User Rejected Date
                          </div>
                          <div
                            class="text-muted"
                            *ngIf="OfferDetailModel.offerStatus == 11"
                          >
                            Offer Cancel Date
                          </div>
                          <div
                            class="text-muted"
                            *ngIf="OfferDetailModel.offerStatus == 12"
                          >
                            Offer Requested Date
                          </div>
                          <div
                            class="text-muted"
                            *ngIf="OfferDetailModel.offerStatus == 13"
                          >
                            Accept Date
                          </div>
                          <div
                            class="text-muted"
                            *ngIf="OfferDetailModel.offerStatus == 14"
                          >
                            Ready To Offer Date
                          </div>
                          <div
                            class="text-muted"
                            *ngIf="OfferDetailModel.offerStatus == 15"
                          >
                            Rarify Date
                          </div>
                        </div>
                      </div>
                      <div
                        class="row mb-2"
                        *ngIf="OfferDetailModel?.installments.length > 0"
                      >
                        <div class="col-sm-12 fw-600">
                          Installments
                          <hr />
                        </div>
                      </div>
                      <div
                        class="row mb-4"
                        *ngIf="OfferDetailModel?.installments.length > 0"
                      >
                        <div
                          class="col-sm-4 mb-2"
                          *ngFor="
                            let installment of OfferDetailModel.installments;
                            let i = index
                          "
                        >
                          <div class="row">
                            <div class="col-sm-12 mb-1">
                              <div class="fw-600 text-capitalize">
                                £ {{ installment.installmentAmount }}
                              </div>
                              <div class="text-muted">
                                Installment {{ i + 1 }}
                              </div>
                            </div>
                          </div>
                          <div class="row">
                            <div class="col-sm-12">
                              <div class="fw-600 text-capitalize">
                                {{
                                  installment.installmentDue
                                    | date : "dd/MM/YYYY"
                                }}
                              </div>
                              <div class="text-muted">
                                Ins. {{ i + 1 }} Due Date
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div
                        class="row mb-4"
                        *ngIf="
                          (OfferDetailModel?.reason != null &&
                            OfferDetailModel.offerStatus == 1) ||
                          (OfferDetailModel?.reason != null &&
                            OfferDetailModel.offerStatus == 3)
                        "
                      >
                        <div class="col-md-4">
                          <div class="fw-600 text-capitalize">
                            {{ OfferDetailModel.reason }}
                          </div>
                          <div class="text-muted">Reason</div>
                        </div>
                      </div>
                      <div
                        class="col-md-12 mb-4"
                        *ngIf="
                          OfferDetailModel.reason != '' &&
                          OfferDetailModel.offerStatus == 8
                        "
                      >
                        <div class="fw-600 text-capitalize">
                          {{ OfferDetailModel.reason }}
                        </div>
                        <div class="text-muted">Reason</div>
                      </div>
                      <div *ngIf="OfferDetailModel.offerStatus == 3">
                        <hr />
                      </div>

                      <div
                        class="row ng-star-inserted mt-1 mb-2"
                        *ngIf="OfferDetailModel.offerStatus == 3"
                      >
                        <label class="mb-2 mt-2 fs-4 text-muted"
                          >Defer Request</label
                        >
                        <div
                          class="col-md-4 mb-3"
                          *ngIf="OfferDetailModel.campuseName != ''"
                        >
                          <div class="fw-600 text-capitalize">
                            {{ OfferDetailModel.campuseName }}
                          </div>
                          <div class="text-muted">Campus</div>
                        </div>
                        <div
                          class="col-md-4 mb-3"
                          *ngIf="OfferDetailModel.courseName != ''"
                        >
                          <div class="fw-600 text-capitalize">
                            {{ OfferDetailModel.courseName }}
                          </div>
                          <div class="text-muted">Course</div>
                        </div>
                        <div
                          class="col-md-4 mb-3"
                          *ngIf="OfferDetailModel.intakeName != ''"
                        >
                          <div class="fw-600 text-capitalize">
                            {{ OfferDetailModel.intakeName }}
                          </div>
                          <div class="text-muted">Intake</div>
                        </div>
                      </div>
                    </div>

                    <div>
                      <button
                        class="btn btn-outline-danger me-2"
                        *ngIf="OfferDetailModel?.offerStatus == 3"
                        (click)="showOfferAlert(8)"
                      >
                        Reject Request
                      </button>
                      <button
                        class="btn-wide btn-shadow btn btn-success m-2"
                        (click)="showOfferAlert(7)"
                        *ngIf="
                          OfferDetailModel?.offerStatus == 3 && IsPriviousOffer
                        "
                      >
                        Approve Request
                      </button>
                      <button
                        class="btn-wide btn-shadow btn btn-success m-2"
                        (click)="showOfferAlert(7)"
                        *ngIf="
                          OfferDetailModel?.offerStatus == 3 && !IsPriviousOffer
                        "
                        disabled
                      >
                        Approve Request
                      </button>
                      <button
                        type="submit"
                        class="btn btn-outline-danger me-2"
                        (click)="cancelOfferReason()"
                        *ngIf="
                          OfferDetailModel?.offerStatus != 11 &&
                          OfferDetailModel?.offerStatus != 12 &&
                          OfferDetailModel?.offerStatus != 14
                        "
                      >
                        Cancel Offer
                      </button>
                      <button
                        type="submit"
                        *ngIf="OfferDetailModel?.offerStatus == 12"
                        class="btn btn-outline-danger me-2"
                        (click)="cancelOfferReason()"
                      >
                        Cancel Request Offer
                      </button>

                      <span>
                        <button
                          *ngIf="
                            OfferDetailModel?.offerStatus == 3 ||
                            OfferDetailModel?.offerStatus == 0 ||
                            OfferDetailModel?.offerStatus == 2 ||
                            OfferDetailModel?.offerStatus == 11 ||
                            OfferDetailModel?.offerStatus == 13 ||
                            OfferDetailModel?.offerStatus == 14
                          "
                          type="submit"
                          class="btn btn-success me-2"
                          (click)="ConfirmReviseOffer()"
                        >
                          Revise an Offer
                        </button>

                        <button
                          *ngIf="
                            OfferDetailModel?.offerStatus == 1 ||
                            OfferDetailModel?.offerStatus == 12
                          "
                          type="submit"
                          class="btn btn-success"
                          (click)="RedirectSaveOffer()"
                        >
                          Send New Offer
                        </button>
                       <!-- <button
                          *ngIf="isShowCondition && offerId > 0"
                          type="button"
                          class="btn btn-primary ms-1"
                          (click)="getOfferConditions()"
                        >
                          Conditions
                        </button>
                         <button
                          *ngIf="isShowCondition && offerId > 0"
                          type="button"
                          class="btn btn-primary ms-1"
                          (click)="openConditionModal()"
                        >
                          Add Conditions
                        </button> -->
                        <button
                          type="button"
                          class="btn btn-secondary ms-1"
                          
                          (click)="
                            ViewOfferLatterfunction(
                              ViewOfferLatter,
                              OfferDetailModel?.offerLetterUrl
                            ) 
                          "
                        >
                          View Offer letter
                        </button>

                        <button
                          *ngIf="OfferDetailModel?.offerStatus == 14"
                          type="button"
                          class="btn btn-primary ms-2"
                          (click)="open(uploadOfferModal)"
                        >
                          Upload Offer Manually
                        </button>
                        <button
                          class="btn btn-success ms-2"
                          *ngIf="OfferDetailModel?.offerStatus == 14"
                          (click)="sendOffer(0)"
                        >
                          Send an Offer
                        </button>

                        <!-- Modal Template -->
                        <ng-template #uploadOfferModal let-modal>
                          <div class="modal-header">
                            <h4 class="modal-title">Upload Offer Manually</h4>
                            <button
                              type="button"
                              class="btn-close"
                              aria-label="Close"
                              (click)="modal.dismiss('Cross click')"
                            ></button>
                          </div>
                          <div class="modal-body">
                            <div class="mb-3">
                              <label
                                for="formFileMultiple"
                                class="form-label fw-bold"
                                >Upload Your Offer Letter (As PDF)</label
                              >
                              <input
                                class="form-control"
                                [ngClass]="{ 'is-invalid': fileInputInvalid }"
                                type="file"
                                id="formFileMultiple"
                                accept=".pdf"
                                (change)="onFileSelected($event)"
                              />
                              <div
                                *ngIf="fileInputInvalid"
                                class="invalid-feedback"
                              >
                                Please select a valid PDF file.
                              </div>
                            </div>
                            <div class="mb-3">
                              <label
                                for="formFileMultipleWord"
                                class="form-label fw-bold"
                                >Upload Your Offer Letter (As Word)</label
                              >
                              <input
                                class="form-control"
                                [ngClass]="{
                                  'is-invalid': wordFileInputInvalid
                                }"
                                type="file"
                                id="formFileMultipleWord"
                                accept=".doc,.docx"
                                (change)="onWordFileSelected($event)"
                              />
                              <div
                                *ngIf="wordFileInputInvalid"
                                class="invalid-feedback"
                              >
                                Please select a valid Word file.
                              </div>
                            </div>
                          </div>
                          <div class="modal-footer">
                            <button
                              #myButton
                              type="button"
                              class="btn btn-secondary"
                              (click)="modal.dismiss('Close click')"
                            >
                              Close
                            </button>
                            <button
                              type="button"
                              class="btn btn-primary"
                              (click)="uploadFiles()"
                            >
                              Upload
                            </button>
                          </div>
                        </ng-template>

                        <!-- PDF Preview Modal -->
                        <ng-template #pdfModal let-modal>
                          <div class="modal-header">
                            <h4 class="modal-title">
                              PDF Offer Letter Preview
                            </h4>
                            <button
                              type="button"
                              class="btn-close"
                              aria-label="Close"
                              (click)="modal.dismiss('Cross click')"
                            ></button>
                          </div>
                          <div class="modal-body">
                            <iframe
                              [src]="Letterfile"
                              width="100%"
                              height="500px"
                            ></iframe>
                          </div>
                          <div class="modal-footer">
                            <button
                              type="button"
                              class="btn btn-secondary"
                              (click)="modal.dismiss('Close click')"
                            >
                              Close
                            </button>
                          </div>
                        </ng-template>

                        <br /><br />
                        <div class="mb-3" *ngIf="false">
                          <label
                            for="formFileMultiple"
                            class="form-label fw-bold"
                            >Upload Your Offer letter From here (As
                            Pdf....)</label
                          >
                          <input
                            class="form-control"
                            [ngClass]="{ 'is-invalid': fileInputInvalid }"
                            type="file"
                            id="formFileMultiple"
                            accept=".pdf"
                            (change)="onFileSelected($event)"
                          />
                          <div
                            *ngIf="fileInputInvalid"
                            class="invalid-feedback"
                          >
                            Please select a valid PDF file.
                          </div>
                        </div>
                        <div class="mb-3" *ngIf="false">
                          <label
                            for="formFileMultipleWord"
                            class="form-label fw-bold"
                            >Upload Your Offer Letter (As Word)</label
                          >
                          <input
                            class="form-control"
                            [ngClass]="{ 'is-invalid': wordFileInputInvalid }"
                            type="file"
                            id="formFileMultipleWord"
                            accept=".doc,.docx"
                            (change)="onWordFileSelected($event)"
                          />
                          <div
                            *ngIf="wordFileInputInvalid"
                            class="invalid-feedback"
                          >
                            Please select a valid Word file.
                          </div>
                        </div>
                        <button
                          *ngIf="false"
                          type="button"
                          class="btn btn-success"
                          (click)="uploadFiles()"
                        >
                          Upload
                        </button>
                      </span>
                    </div>
                  </div>
                  <div class="row" *ngIf="previousOffer.length > 0">
                    <div class="col-sm-12">
                      <table class="table">
                        <thead>
                          <tr>
                            <th>Offer Name</th>
                            <th>Offer Status</th>
                            <th>Offer Date</th>
                            <th>Action</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr *ngFor="let offer of previousOffer">
                            <td>{{ offer.applicationOfferName }}</td>
                            <td>
                              <span
                                *ngIf="offer.offerType == 1"
                                class="text-danger text-capitalize me-1 fw-600 fsize-1"
                              >
                                Offer Declined</span
                              >
                              <span
                                *ngIf="offer.offerType == 0"
                                class="text-warning text-capitalize me-1 fw-600 fsize-1"
                              >
                                Offer Pending</span
                              >
                              <span
                                *ngIf="offer.offerType == 14"
                                class="text-warning text-capitalize me-1 fw-600 fsize-1"
                              >
                                Ready to Offer</span
                              >
                              <span
                                *ngIf="offer.offerType == 2"
                                class="text-success text-capitalize me-1 fw-600 fsize-1"
                              >
                                Offer Accepted</span
                              >
                              <span
                                *ngIf="offer.offerType == 3"
                                class="text-success text-capitalize me-1 fw-600 fsize-1"
                              >
                              Defer Offer is Requested</span
                              >
                              <span
                                *ngIf="offer.offerType == 4"
                                class="text-success text-capitalize me-1 fw-600 fsize-1"
                              >
                                Your offer Has Been Withdrawn</span
                              >
                              <span
                                *ngIf="offer.offerType == 7"
                                class="text-success text-capitalize me-1 fw-600 fsize-1"
                              >
                                Defer offer request is Accepted</span
                              >
                              <span
                                *ngIf="offer.offerType == 13"
                                class="text-success text-capitalize me-1 fw-600 fsize-1"
                              >
                                Accepted</span
                              >
                              <span
                                *ngIf="offer.offerType == 8"
                                class="text-danger text-capitalize me-1 fw-600 fsize-1"
                              >
                                Defer offer request is rejected</span
                              >
                              <span
                                *ngIf="offer.offerType == 5"
                                class="text-danger text-capitalize me-1 fw-600 fsize-1"
                              >
                                offer is On-Hold
                              </span>
                              <span
                                *ngIf="offer.offerType == 6"
                                class="text-danger text-capitalize me-1 fw-600 fsize-1"
                              >
                                Offer is Expire</span
                              >
                              <span
                                *ngIf="offer.offerType == 8"
                                class="text-danger text-capitalize me-1 fw-600 fsize-1"
                              >
                                (Reason :- {{ offer.deferReason }} )</span
                              >
                              <span
                                *ngIf="offer.offerType == 9"
                                class="text-success text-capitalize me-1 fw-600 fsize-1"
                              >
                                - Continued with offer</span
                              >
                              <span
                                *ngIf="offer.offerType == 11"
                                class="text-danger text-capitalize me-1 fw-600 fsize-1"
                              >
                                Offer was canceled</span
                              >
                              <span
                                *ngIf="offer.offerType == 12"
                                class="text-primary text-capitalize me-1 mt-1 fw-600 fsize-1"
                              >
                                Offer Requested</span
                              >
                              <span
                                *ngIf="offer.offerType == 10"
                                class="text-danger text-capitalize me-1 fw-600 fsize-1"
                              >
                                You Have Rejected this Offer</span
                              >
                            </td>
                            <td>
                              {{ offer.createdDate | date : "dd/MM/YYYY" }}
                            </td>

                            <td class="text-left text-nowrap">
                              <button
                                class="me-2 btn-sm btn-info fa fa-eye"
                                (click)="
                                  ViewOfferLatterfunction(
                                    ViewOfferLatter,
                                    offer.offerLetterUrl
                                  )
                                "
                              ></button>
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="accordion-item">
              <h2
                class="accordion-header"
                id="finance"
                (click)="setmetgroupindex(3)"
              >
                <button
                  class="accordion-button fw-bold collapsed"
                  type="button"
                  data-bs-toggle="collapse"
                  data-bs-target="#finance-details"
                  aria-expanded="false"
                  aria-controls="finance-details"
                >
                  Finance
                </button>
              </h2>
              <div
                id="finance-details"
                class="accordion-collapse collapse"
                aria-labelledby="finance"
                data-bs-parent="#accordionFlushExample"
              >
                <div class="accordion-body">
                  <table class="table">
                    <thead>
                      <tr>
                        <th>Installment Type</th>
                        <th>Total Amount</th>
                        <th>Paid Amount</th>
                        <th>Payment Date</th>
                        <th>Due Date</th>
                        <th>Status</th>
                        <th>Action</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr *ngFor="let installment of installmentList">
                        <td>{{ installment.installmentType }}</td>
                        <td>{{ installment.totalInstallmentAmount }}</td>
                        <td>{{ installment.paidInstallmentAmount }}</td>
                        <td>
                          {{ installment.paymentDate | date : "dd/MM/YYYY" }}
                        </td>
                        <td>
                          {{
                            installment.installmentDueDate | date : "dd/MM/YYYY"
                          }}
                        </td>
                        <td class="text-uppercase">
                          <span
                            class="badge rounded-pill"
                            [ngClass]="
                              installment.status.toLowerCase() == 'paid'
                                ? 'bg-success'
                                : 'bg-warning'
                            "
                          >
                            <ng-container
                              *ngIf="
                                installment.paidInstallmentAmount > 0 &&
                                installment.totalInstallmentAmount !=
                                  installment.paidInstallmentAmount
                              "
                            >
                              Partially</ng-container
                            >
                            {{ installment.status }}
                          </span>
                        </td>
                        <td class="text-uppercase">
                          <button
                            class="btn btn-warning py-0 px-2 fa fa-upload me-2"
                            (click)="UploadReceipt(installment.installmentNo)"
                          ></button>
                          <button
                            class="btn py-0 px-2 fa fa-eye"
                            [ngClass]="
                              installment.paidInstallmentAmount > 0
                                ? 'btn-info'
                                : 'btn-secondary'
                            "
                            (click)="
                              GetAllReceipt(
                                installment.applicationId,
                                installment.installmentNo,
                                installment.installmentType
                              )
                            "
                          ></button>
                          <!-- [disabled]="installment.paidInstallmentAmount==0" -->
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
            <!-- <div class="accordion-item">
              <h2 class="accordion-header" id="visa" (click)="setmetgroupindex(5)">
                <button class="accordion-button fw-bold collapsed" type="button" data-bs-toggle="collapse"
                  data-bs-target="#visa-details" aria-expanded="false" aria-controls="visa-details">
                  Visa
                </button>
              </h2>
              <div id="ukvi-details" class="accordion-collapse collapse" aria-labelledby="ukvi"
                data-bs-parent="#accordionFlushExample">
                <div class="accordion-body">
                  <div class="modal-tab-scroll">
                    <perfect-scrollbar>
                      <ng-container *ngIf="CasIssueData.length>0">
                        <div class="col-sm-12"
                          *ngIf="CasIssueData[0].casStatusName == 'Active' && CasIssueData[0].casStatus != 6 && IsVisa == true">
                          <button class="btn btn-primary float-end" (click)="openModal(CasReportModal)">Cas
                            Report</button>
                        </div>
                      </ng-container>
                      <div *ngIf="userType =='1' && CasIssueData.length ==0 || IsExpire || isCASWithrow">
                        <form [formGroup]="CsaIssueFileForm" (ngSubmit)="UploadCsaFile()">
                          <div class="row mt-4 mx-0">
                            <div class="col-md-4">
                              <label class="mb-2">CAS Reference Number</label>
                              <input type="text" formControlName="CasNumber" class="form-control"
                                placeholder="i.e. E4G0AE1H42SOJ4" maxlength="14">
                              <div *ngIf="f['CasNumber'].errors">
                                <span *ngIf="isSubmitted && f['CasNumber'].errors['required']"
                                  class="text-danger">Please
                                  enter CAS
                                  number.</span>
                                <span *ngIf="f['CasNumber'].errors['pattern']" class="text-danger">Please enter
                                  14 character for CAS number
                                </span>
                              </div>
                            </div>

                            <div class="col-md-4">
                              <div class="form-group">
                                <label class="mb-2">CAS Certificate</label>
                                <input type="file" formControlName="FileName" class="form-control mb-2"
                                  (change)="changeCsafile($event)">
                                <div *ngIf="!isValidFile">
                                  <span class="text-danger">Please choose valid file
                                    type.</span>
                                </div>
                                <div *ngIf="isFormSubmitted && f['FileName'].errors">
                                  <span *ngIf="f['FileName'].errors['required']" class="text-danger">Please chose
                                    file</span>
                                </div>
                              </div>
                            </div>

                            <div class="col-md-4">
                              <label class="mb-2">CAS Issue Date</label>
                              <input type="date" formControlName="IssueDate" class="form-control" max={{SetDate}}>
                              <div *ngIf="isSubmitted && f['IssueDate'].errors">
                                <span *ngIf="f['IssueDate'].errors['required']" class="text-danger">Please select
                                  IssueDate</span>
                              </div>
                            </div>

                            <div>
                              <button class="btn-transition btn btn-outline-danger me-2" (click)="Datarefrace()"
                                type="button">Cancel</button>

                              <button class="btn btn-success m-2" *ngIf="!IsExpire" type="submit">Issue</button>
                              <button *ngIf="IsExpire" class="btn btn-success m-2" type="submit">Re-Issue</button>
                            </div>
                          </div>
                        </form>
                      </div>
                      <div *ngIf="userType!=='1' ">CAS not Issued</div>

                      <ng-container *ngIf="CasIssueData.length > 0">
                        <table class="table m-2">
                          <thead>
                            <tr>
                              <th>Issue Date</th>
                              <th>UKVI Number</th>
                              <th>Status</th>
                              <th>Action</th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr *ngFor="let CsaIssue of CasIssueData">
                              <td>{{CsaIssue.issueDate | date:'dd/MM/YYYY'}}</td>
                              <td>{{CsaIssue.casNumber}}</td>
                              <td><i *ngIf="!CsaIssue.isExpire && CsaIssue.casStatusName == 'Active'"
                                  class="text-success fw-500 ms-1">
                                  {{CsaIssue.casStatusName}}</i>
                                <i *ngIf="!CsaIssue.isExpire && CsaIssue.casStatusName == 'Withdraw'"
                                  class="text-danger fw-500 ms-1">
                                  {{CsaIssue.casStatusName}}</i>
                                <i *ngIf="CsaIssue.casStatusName == 'Reported'" class="text-danger fw-500 ms-1">
                                  {{CsaIssue.casStatusName}}</i>
                              </td>
                              <td>
                                <div class="me-2 btn-primary btn fsize-1 px-1 py-0">
                                  <i class="fa fa-eye" title="View"
                                    (click)="OpenCASUrlModal(CsaIssue.fileUrl,CsaIssue.applicationId)"></i>
                                </div>

                                <div class="me-2 btn-primary btn fsize-1 px-1 py-0"
                                  *ngIf="CsaIssue.casStatusName != 'Withdraw'">
                                  <i class="fa fa-plus" title="Withdrown"
                                    (click)="CaseWithdrown(CsaIssue.applicationId)"></i>
                                </div>

                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </ng-container>

                      <div class="row mx-0">

                        <div class="col-12 my-3">
                          <mat-slide-toggle class="example-margin" [color]="color" [checked]="isRequired"
                            (change)="IsVisaStudent()">
                            Visa Required
                          </mat-slide-toggle>



                          <div class="modal-body">
                            <div class="row">
                              <div class="col-sm-12">
                                <div class="row">

                                  <form [formGroup]="Visaform" (ngSubmit)="saveVisaform()" *ngIf="isRequired">
                                    <div class="col-sm-12 mb-2">
                                      <input type="hidden" formControlName="applicationId">
                                      <label class="form-label">Visa Status <span class="text-danger">*</span></label>
                                      <select name="visa" id="visa" class="form-control" formControlName="statusId"
                                        (change)="changestatuss($event.target.value)" *ngIf="once">

                                        <option value='1'>
                                          InPreparation
                                        </option>
                                      </select>
                                      <div *ngIf="IsVisa">
                                        <div *ngIf="visaData">
                                          <select name="visa" id="visa" class="form-control" formControlName="statusId"
                                            (change)="changestatuss($event.target.value)">


                                            <option value='1'
                                              *ngIf="visaData.visaStatus != 2 && visaData.visaStatus != 4 && visaData.visaStatus != 5&&visaData.visaStatus != 3">
                                              InPreparation
                                            </option>
                                            <option value='2'
                                              *ngIf="(!firsttimecheck && Statusvalue == 2 && AfterStatusvalue == 3) || (!firsttimecheck && Statusvalue == 5) || Statusvalue == 1||(visaData.visaStatus == 1||visaData.visaStatus == 2||visaData.visaStatus == 5)">
                                              Application Submited</option>
                                            <option value='3'
                                              *ngIf="(!firsttimecheck && Statusvalue == 3 && AfterStatusvalue == 4) || (!firsttimecheck && Statusvalue == 2 && AfterStatusvalue == 3)||(visaData.visaStatus == 2||visaData.visaStatus == 3)">
                                              Granted</option>
                                            <option value='4'
                                              *ngIf="(!firsttimecheck && Statusvalue == 4 && AfterStatusvalue == 5) || (!firsttimecheck && Statusvalue == 2 && AfterStatusvalue == 3)||(visaData.visaStatus == 2||visaData.visaStatus == 4)">
                                              Refused</option>
                                            <option value='5'
                                              *ngIf="(!firsttimecheck && Statusvalue == 5 && AfterStatusvalue == 2) || (!firsttimecheck && Statusvalue == 4 && AfterStatusvalue == 5)||(visaData.visaStatus == 2||visaData.visaStatus == 4||visaData.visaStatus == 5)">
                                              ReApply</option>

                                          </select>
                                        </div>
                                      </div>
                                      <div *ngIf="ff['statusId'].touched && ff['statusId'].errors">
                                        <span *ngIf="ff['statusId'].errors['required']" class="text-danger">Visa Status
                                          is
                                          required.</span>
                                      </div>
                                    </div>
                                    <div class="col-sm-12 mb-2" *ngIf="!valuecheck">
                                      <label class="form-label">Draft URL <span class="text-danger">*</span></label>
                                      <input type="url" class="form-control" formControlName="applicationUrl"
                                        placeholder="http://" />
                                      <div *ngIf="ff['applicationUrl'].touched && ff['applicationUrl'].errors">
                                        <span *ngIf="ff['applicationUrl'].errors['required']" class="text-danger">Draft
                                          Url is
                                          required.</span>
                                      </div>
                                    </div>

                                    <div class="col-sm-12 mb-2" *ngIf="valuecheck">
                                      <label class="form-label">{{datelabel}} <span class="text-danger">*</span></label>
                                      <input type="date" *ngIf="statuValue == 1" class="form-control" max={{SetDate}}
                                        formControlName="statusDate" placeholder="dd/mm/yy" />

                                      <input type="date" *ngIf="statuValue != 1  && statuValue != 3  && statuValue != 4"
                                        class="form-control" formControlName="statusDate" placeholder="dd/mm/yy"
                                        max={{SetDate}} />
                                      <input type="date" *ngIf="statuValue == 3" class="form-control"
                                        formControlName="statusDate" placeholder="dd/mm/yy" max={{SetGrantedDate}} />
                                      <input type="date" *ngIf="statuValue == 4" class="form-control"
                                        formControlName="statusDate" placeholder="dd/mm/yy" max={{SetGrantedDate}} />

                                      <div *ngIf="ff['statusDate'].touched && ff['statusDate'].errors">
                                        <span *ngIf="ff['statusDate'].errors['required']" class="text-danger">Date is
                                          required.</span>
                                      </div>
                                    </div>
                                    <div class="col-sm-12 mb-2" *ngIf="valuecheck && statuValue == 4 && valuecheck">
                                      <label class="form-label">Reason <span
                                          class="text-danger">{{removestar}}</span></label>
                                      <input type="text" formControlName="reason" class="form-control"
                                        placeholder="Enter the Reason for Status Change">
                                      <div *ngIf="ff['reason'].touched && ff['reason'].errors">
                                        <span *ngIf="ff['reason'].errors['required']" class="text-danger">Reason is
                                          required.</span>
                                      </div>
                                    </div>

                                    <div class="col-sm-12 mb-2" *ngIf="valuecheck && statuValue == 4">
                                      <label class="form-label">Visa Document <span
                                          class="text-danger">{{removestar}}</span></label>


                                      <input type="file" class="form-control" (change)="SelectVisa($event)">
                                      <div *ngIf="fileName">{{fileName}}</div>
                                      <div *ngIf="ff['fileContent'].errors && isSubmitted">
                                        <span *ngIf="ff['fileContent'].errors['required']" class="text-danger">Please
                                          Choose
                                          document.
                                        </span>
                                      </div>

                                    </div>
                                    <div class="col-sm-4 mb-2">
                                      <button type="submit" class="btn btn-success me-2">Submit</button>
                                    </div>
                                    <div class="col-sm-12 mt-3 text-danger" *ngIf="visadetailsData?.reason">
                                      {{visadetailsData?.reason}}
                                    </div>
                                    <div class="col-sm-12 mb-2"
                                      *ngIf="statuValue == 1 || visadetailsData?.visaStatus == '' || visadetailsData?.visaStatus == null">

                                      <p>Note:<span class="text-muted fst-italic">
                                          We would request you to save the application for
                                          visa and share the URL here with us so we can review the application which
                                          will
                                          ensure that you are submitting the correct information on the visa application
                                          that would
                                          avoid or reduce the chance of rejections
                                        </span>
                                      </p>
                                    </div>
                                  </form>
                                </div>
                                <p *ngIf="visadetailsData?.isAllGood == true" class="text-success">Admin has approved
                                  visa
                                  applying changes</p>

                              </div>


                            </div>
                          </div>




                          <div *ngIf="IsVisa">
                            <ng-container *ngIf="visaData">
                              <hr>
                              <h4 class="ms-2 fw-600">Visa Updates</h4>
                              <div class="row my-3 mx-2">
                                <div class="col-4">
                                  <div class="fsize-2 fw-600 text-capitalize mb-1 text-info"
                                    *ngIf="visaData.visaStatus == 1">
                                    InPreparation</div>

                                  <div class="fsize-2 fw-600 text-capitalize mb-1 text-warning"
                                    *ngIf="visaData.visaStatus == 2">
                                    Awaiting</div>
                                  <div class="fsize-2 fw-600 text-capitalize mb-1 text-warning"
                                    *ngIf="visaData.visaStatus == 4">
                                    Refused</div>
                                  <div class="fsize-2 fw-600 text-capitalize mb-1 text-success"
                                    *ngIf="visaData.visaStatus == 3">
                                    Granted</div>
                                  <div class="fsize-2 fw-600 text-capitalize mb-1 text-info"
                                    *ngIf="visaData.visaStatus == 5">
                                    Reapplied</div>
                                  <div class="doc-label fsize-1 text-capitalize">Status</div>
                                </div>

                                <div class="col-4" *ngIf="visaData.visaApplicationUrl">
                                  <a class="fsize-2 text-primary fw-600 pointer" target="_blank"
                                    href="{{visaData.visaApplicationUrl}}">VIEW</a>
                                  <div class="doc-label fsize-1 text-capitalize">Application Draft</div>
                                </div>
                              </div>
                              <div class="form-group mt-4"
                                *ngIf="visaData.visaApplicationUrl && visaData.isAllGood == false">
                                <form [formGroup]="VisaCoreForm" (ngSubmit)="VisaCorectionAdd()">
                                  <div class="row">
                                    <div class="col-sm-12">
                                      <div class="mx-3 mb-2">
                                        <label for="VisaCorrection">Visa Application Correction</label>
                                      </div>
                                      <div class="overflow-auto mx-3">
                                        <input type="hidden" formControlName="visaId">
                                        <input type="text" name="VisaCorrection" id="VisaCorrection"
                                          placeholder="Enter Corrections" class="form-control" formControlName="reason">
                                        <div *ngIf="fVisaform['reason'].touched && fVisaform['reason'].errors">
                                          <span *ngIf="fVisaform['reason'].errors['required']"
                                            class="text-danger">Please
                                            Enter
                                            Reason</span>
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                  <div class="row mt-3">
                                    <div class="col-sm-12 mx-3">
                                      <input type="submit" class="btn btn-outline-secondary" value="Send Changes">
                                      <input type="button" value="All Good!"
                                        (click)="VisaAllGood(visaData.applicationId); setmetgroupindex($event);"
                                        class="btn btn-success mx-2">
                                    </div>
                                  </div>
                                </form>
                              </div>
                              <div class="text-success" *ngIf="visaData.isAllGood">
                                Admin has approved Visa applying changes
                              </div>
                            </ng-container>
                          </div>

                        </div>
                      </div>

                    </perfect-scrollbar>
                  </div>
                </div>
              </div>
            </div> -->
            <!-- *ngIf="isVisaSectionVisible" -->
            <div class="accordion-item" (click)="setmetgroupindex(5)" *ngIf="isVisaSectionVisible" >
              <h2 class="accordion-header" id="visa">
                <button
                  class="accordion-button fw-bold collapsed"
                  type="button"
                  data-bs-toggle="collapse"
                  data-bs-target="#visa-details"
                  aria-expanded="false"
                  aria-controls="visa-details"
                  [disabled]="isVisaSectionDisabled"
                >
                  Visa
                </button>
              </h2>
            </div>
            <div
              id="visa-details"
              class="accordion-collapse collapse"
              aria-labelledby="visa"
              data-bs-parent="#accordionFlushExample"
            >
              <div class="accordion-body">
                <div class="modal-tab-scroll">
                  <perfect-scrollbar>
                    <mat-slide-toggle
                      class="example-margin"
                      [color]="color"
                      [checked]="isRequired"
                      (change)="IsVisaStudent()"
                    >
                      Visa Required
                    </mat-slide-toggle>
                    <ng-container *ngIf="CasIssueData.length > 0">
                      <div
                        class="col-sm-12"
                        *ngIf="
                          CasIssueData[0].casStatusName == 'Active' &&
                          CasIssueData[0].casStatus != 6 &&
                          IsVisa == true
                        "
                      >
                        <button
                          class="btn btn-primary float-end"
                          (click)="openModal(CasReportModal)"
                        >
                          Cas Report
                        </button>
                      </div>
                    </ng-container>

                    <div
                      *ngIf="
                        (userType == '1' &&
                          VisaLinkDataListLastRecord?.visaLinkStatus == 3 &&
                          IsVisa) ||
                        (userType == '1' &&
                          VisaLinkDataList.length == 0 &&
                          IsVisa)
                      "
                    >

                    <!-- Taha Said us to hide this -->
                      <!-- <form [formGroup]="CasLinkModel" (ngSubmit)="SaveLink()">
                        <div class="row mt-4 mx-0">
                          <div class="col-md-8">
                            <label class="mb-2">CAS Reference Link</label>
                            <input
                              type="url"
                              formControlName="CasLink"
                              class="form-control"
                              placeholder="Please mention the corrections you want."
                            />
                            <div
                              *ngIf="isSubmitteds && fLink['CasLink'].errors"
                            >
                              <span
                                *ngIf="
                                  isSubmitteds &&
                                  fLink['CasLink'].errors['required']
                                "
                                class="text-danger"
                                >Please Enter CAS Reference Link.</span
                              >
                            </div>
                          </div>
                          <div class="col-md-4" style="margin-top: 28px">
                            <button class="btn btn-success mb-2" type="submit">
                              Submit
                            </button>
                          </div>
                        </div>
                      </form> -->
                  
                    <div
                      *ngIf="
                        userType == '1' &&
                        ((CasIssueData.length == 0 &&
                          VisaLinkDataList.length != 0) ||
                          IsExpire ||
                          isCASWithrow) &&
                        IsVisa &&
                        VisaLinkDataList.length != 0
                      "
                    >
                      <table class="table m-2">
                        <thead>
                          <tr>
                            <th>Link Created Date</th>
                            <th>Status</th>
                            <th style="width: 300px">Reason</th>
                            <th>Link</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr *ngFor="let VisaLink of VisaLinkDataList">
                            <td>
                              {{
                                VisaLink.createdDate | date : "HH:mm dd/MM/YYYY"
                              }}
                            </td>
                            <td>
                              <i
                                *ngIf="VisaLink.visaLinkStatus == 1"
                                class="text-warning fw-500 ms-1"
                              >
                                Review Pending
                              </i>
                              <i
                                *ngIf="VisaLink.visaLinkStatus == 2"
                                class="text-success fw-500 ms-1"
                              >
                                All Is Good
                              </i>
                              <i
                                *ngIf="VisaLink.visaLinkStatus == 3"
                                class="text-danger fw-500 ms-1"
                              >
                                Correction needed
                              </i>
                            </td>
                            <td style="width: 300px">{{ VisaLink.reason }}</td>
                            <td>
                              <a href="{{ VisaLink.link }}" target="_blank"
                                >View</a
                              >
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                    <!-- <hr /> -->
                    <div
                      *ngIf="
                        userType == '1' &&
                        (CasIssueData.length == 0 ||
                          IsExpire ||
                          isCASWithrow) &&
                        IsVisa
                      "
                    >
                  </div>
                  <!-- *ngIf="!isFormSubmittedSuccessfully"  -->
                    <div *ngIf="!submissionStatus[StoreApplicatoinId] && (CasIssueData.length == 0 || showCasForm)">
                      <form
                        [formGroup]="CsaIssueFileForm"
                        (ngSubmit)="UploadCsaFile()"
                      >
                        <div class="row mt-4 mx-0">
                          <div class="col-md-4">
                            <label class="mb-2">CAS Reference Number <span class="text-danger">*</span></label>
                            
                            <input
                              type="text"
                              formControlName="CasNumber"
                              class="form-control"
                              placeholder="i.e. E4G0AE1H42SOJ4"
                              maxlength="14"
                            />
                            <div *ngIf="f['CasNumber'].errors">
                              <span
                                *ngIf="
                                  isSubmitted &&
                                  f['CasNumber'].errors['required']
                                "
                                class="text-danger"
                                >Please enter CAS number.</span
                              >
                              <span
                                *ngIf="f['CasNumber'].errors['pattern']"
                                class="text-danger"
                                >Please enter 14 character for CAS number
                              </span>
                            </div>
                          </div>

                          <div class="col-md-4">
                            <div class="form-group">
                              <label class="mb-2">CAS Certificate <span class="text-danger">*</span></label>
                              <input
                                type="file"
                                formControlName="FileName"
                                class="form-control mb-2"
                                (change)="changeCsafile($event)"
                              />
                              <div *ngIf="!isValidFile">
                                <span class="text-danger"
                                  >Please choose valid file type.</span
                                >
                              </div>
                              <div
                                *ngIf="isFormSubmitted && f['FileName'].errors"
                              >
                                <span
                                  *ngIf="f['FileName'].errors['required']"
                                  class="text-danger"
                                  >Please chose file</span
                                >
                              </div>
                            </div>
                          </div>

                          <div class="col-md-4">
                            <label class="mb-2">CAS Issue Date <span class="text-danger">*</span></label>
                            <input
                              type="date"
                              formControlName="IssueDate"
                              class="form-control"
                              max="{{ SetDate }}"
                            />
                            <div *ngIf="isSubmitted && f['IssueDate'].errors">
                              <span
                                *ngIf="f['IssueDate'].errors['required']"
                                class="text-danger"
                                >Please select IssueDate</span
                              >
                            </div>
                          </div>

                          <div>
                            <button
                              class="btn-transition btn btn-outline-danger me-2"
                              (click)="Datarefrace()"
                              type="button"
                            >
                              Cancel
                            </button>

                            <button
                              class="btn btn-success m-2"
                              *ngIf="!IsExpire"
                              type="submit"
                            >
                              Issue
                            </button>
                            <button
                              *ngIf="IsExpire"
                              class="btn btn-success m-2"
                              type="submit"
                            >
                              Reissue
                            </button>
                          </div>
                        </div>
                      </form>
                    </div>
                    </div>
                    <div *ngIf="userType !== '1'">CAS not Issued</div>
                   
                    <ng-container *ngIf="CasIssueData.length > 0">
                      <table class="table m-2">
                        <thead>
                          <tr>
                            <th>Issue Date</th>
                            <th>UKVI Number</th>
                            <th>Status</th>
                            <th>Action</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr *ngFor="let CsaIssue of CasIssueData">
                            <td>
                            
                              {{ CsaIssue.issueDate | date : "dd/MM/YYYY" }}
                            </td>
                            <td>{{ CsaIssue.casNumber }}</td>
                            <td>
                              
                              <i
                                *ngIf="                                  
                                  CsaIssue.casStatusName == 'Expired'
                                "
                                class="text-danger fw-500 ms-1"
                              >
                                {{ CsaIssue.casStatusName }}</i
                              >
                              
                              <i
                                *ngIf="                                  
                                  CsaIssue.casStatusName == 'Active'
                                "
                                class="text-success fw-500 ms-1"
                              >
                                {{ CsaIssue.casStatusName }}</i
                              >
                              <i
                                *ngIf="
                                  
                                  CsaIssue.casStatusName == 'Withdraw'
                                "
                                class="text-danger fw-500 ms-1"
                              >
                                {{ CsaIssue.casStatusName }}</i
                              >
                              <i
                                *ngIf="CsaIssue.casStatusName == 'Reported'"
                                class="text-danger fw-500 ms-1"
                              >
                                {{ CsaIssue.casStatusName }}</i
                              >
                            </td>
                            <td>
                              <div
                                class="me-2 btn-primary btn fsize-1 px-1 py-0"
                              >
                                <i
                                  class="fa fa-eye"
                                  title="View"
                                  (click)="
                                    OpenCASUrlModal(
                                      CsaIssue.fileUrl,
                                      CsaIssue.applicationId
                                    )
                                  "
                                ></i>
                              </div>

                              <div
                                class="me-2 btn-primary btn fsize-1 px-1 py-0"
                                *ngIf="CsaIssue.casStatusName != 'Withdraw'"
                              >
                                <i
                                  class="fa fa-sign-out"
                                  title="withdrawn"
                                  (click)="
                                    CaseWithdrown(CsaIssue.applicationId)
                                  "
                                ></i>
                              </div>

                              <!-- *ngIf="isFormSubmittedSuccessfully &&" -->
                              <div *ngIf="!showCasForm" class="me-2 btn-primary btn fsize-1 px-1 py-0"
                              >
                              <i class="bi bi-arrow-counterclockwise"
                              title="Reissue "  (click)="ReIssueCasFile()"
                              ></i>
                            </div>
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </ng-container>

                    <div class="row mx-0">
                      <div class="col-12 my-3">
                        <div
                          class="body"
                          *ngIf="IsVisa && CasIssueData.length > 0"
                        >
                          <div class="row mt-2">
                            <div class="col-sm-12">
                              <div class="row">
                                <form
                                  [formGroup]="Visaform"
                                  (ngSubmit)="saveVisaform()"
                                  *ngIf="isRequired"
                                >
                                  <div class="col-sm-12 mb-2">
                                    <input
                                      type="hidden"
                                      formControlName="applicationId"
                                    />
                                    <label class="form-label"
                                      >Visa Status
                                      <span class="text-danger">*</span></label
                                    >
                                    <select
                                      name="visa"
                                      id="visa"
                                      class="form-control"
                                      formControlName="statusId"
                                      (change)="
                                        changestatuss($event.target.value)
                                      "
                                      *ngIf="once"
                                    >
                                      <option value="1">InPreparation</option>
                                    </select>
                                    <div *ngIf="IsVisa">
                                      <div *ngIf="visaData">
                                        <select
                                          name="visa"
                                          id="visa"
                                          class="form-control"
                                          formControlName="statusId"
                                          (change)="
                                            changestatuss($event.target.value)
                                          "
                                        >
                                          <option
                                            value="1"
                                            *ngIf="
                                              visaData.visaStatus != 2 &&
                                              visaData.visaStatus != 4 &&
                                              visaData.visaStatus != 5 &&
                                              visaData.visaStatus != 3
                                            "
                                          >
                                            InPreparation
                                          </option>
                                          <option
                                            value="2"
                                            *ngIf="
                                              (!firsttimecheck &&
                                                Statusvalue == 2 &&
                                                AfterStatusvalue == 3) ||
                                              (!firsttimecheck &&
                                                Statusvalue == 5) ||
                                              Statusvalue == 1 ||
                                              visaData.visaStatus == 1 ||
                                              visaData.visaStatus == 2 ||
                                              visaData.visaStatus == 5
                                            "
                                          >
                                            Application Submited
                                          </option>
                                          <option
                                            value="3"
                                            *ngIf="
                                              (!firsttimecheck &&
                                                Statusvalue == 3 &&
                                                AfterStatusvalue == 4) ||
                                              (!firsttimecheck &&
                                                Statusvalue == 2 &&
                                                AfterStatusvalue == 3) ||
                                              visaData.visaStatus == 2 ||
                                              visaData.visaStatus == 3
                                            "
                                          >
                                            Granted
                                          </option>
                                          <option
                                            value="4"
                                            *ngIf="
                                              (!firsttimecheck &&
                                                Statusvalue == 4 &&
                                                AfterStatusvalue == 5) ||
                                              (!firsttimecheck &&
                                                Statusvalue == 2 &&
                                                AfterStatusvalue == 3) ||
                                              visaData.visaStatus == 2 ||
                                              visaData.visaStatus == 4
                                            "
                                          >
                                            Refused
                                          </option>
                                          <option
                                            value="5"
                                            *ngIf="
                                              (!firsttimecheck &&
                                                Statusvalue == 5 &&
                                                AfterStatusvalue == 2) ||
                                              (!firsttimecheck &&
                                                Statusvalue == 4 &&
                                                AfterStatusvalue == 5) ||
                                              visaData.visaStatus == 2 ||
                                              visaData.visaStatus == 4 ||
                                              visaData.visaStatus == 5
                                            "
                                          >
                                            ReApply
                                          </option>
                                        </select>
                                      </div>
                                    </div>
                                    <div
                                      *ngIf="
                                        ff['statusId'].touched &&
                                        ff['statusId'].errors
                                      "
                                    >
                                      <span
                                        *ngIf="
                                          ff['statusId'].errors['required']
                                        "
                                        class="text-danger"
                                        >Visa Status is required.</span
                                      >
                                    </div>
                                  </div>
                                  <div
                                    class="col-sm-12 mb-2"
                                    *ngIf="!valuecheck"
                                  >
                                    <label class="form-label"
                                      >Draft URL
                                      <span class="text-danger"></span
                                    ></label>
                                    <input
                                      type="url"
                                      class="form-control"
                                      formControlName="applicationUrl"
                                      placeholder="http://"
                                    />
                                    <div
                                      *ngIf="
                                        ff['applicationUrl'].touched &&
                                        ff['applicationUrl'].errors
                                      "
                                    >
                                      <span
                                        *ngIf="
                                          ff['applicationUrl'].errors[
                                            'required'
                                          ]
                                        "
                                        class="text-danger"
                                        >Draft Url is required.</span
                                      >
                                    </div>
                                  </div>
                                  <div
                                    class="col-sm-12 mb-2"
                                    *ngIf="!valuecheck"
                                  >
                                    <label class="form-label"
                                      >Upload PDF
                                      <span class="text-danger">*</span></label
                                    >
                                    <input
                                      type="file"
                                      class="form-control"
                                      (change)="onFile($event)"
                                      accept=".pdf"
                                    />
                                  </div>

                                  <div
                                    class="col-sm-12 mb-2"
                                    *ngIf="valuecheck"
                                  >
                                    <label class="form-label"
                                      >{{ datelabel }}
                                      <span class="text-danger">*</span></label
                                    >
                                    <input
                                      type="date"
                                      *ngIf="statuValue == 1"
                                      class="form-control"
                                      max="{{ SetDate }}"
                                      formControlName="statusDate"
                                      placeholder="dd/mm/yy"
                                    />

                                    <input
                                      type="date"
                                      *ngIf="
                                        statuValue != 1 &&
                                        statuValue != 3 &&
                                        statuValue != 4
                                      "
                                      class="form-control"
                                      formControlName="statusDate"
                                      placeholder="dd/mm/yy"
                                      max="{{ SetDate }}"
                                    />
                                    <input
                                      type="date"
                                      *ngIf="statuValue == 3"
                                      class="form-control"
                                      formControlName="statusDate"
                                      placeholder="dd/mm/yy"
                                      max="{{ SetGrantedDate }}"
                                    />
                                    <input
                                      type="date"
                                      *ngIf="statuValue == 4"
                                      class="form-control"
                                      formControlName="statusDate"
                                      placeholder="dd/mm/yy"
                                      max="{{ SetGrantedDate }}"
                                    />

                                    <div
                                      *ngIf="
                                        ff['statusDate'].touched &&
                                        ff['statusDate'].errors
                                      "
                                    >
                                      <span
                                        *ngIf="
                                          ff['statusDate'].errors['required']
                                        "
                                        class="text-danger"
                                        >Date is required.</span
                                      >
                                    </div>
                                  </div>
                                  <div
                                    class="col-sm-12 mb-2"
                                    *ngIf="
                                      valuecheck &&
                                      statuValue == 4 &&
                                      valuecheck
                                    "
                                  >
                                    <label class="form-label"
                                      >Reason
                                      <span class="text-danger">{{
                                        removestar
                                      }}</span></label
                                    >
                                    <input
                                      type="text"
                                      formControlName="reason"
                                      class="form-control"
                                      placeholder="Enter the Reason for Status Change"
                                    />
                                    <div
                                      *ngIf="
                                        ff['reason'].touched &&
                                        ff['reason'].errors
                                      "
                                    >
                                      <span
                                        *ngIf="ff['reason'].errors['required']"
                                        class="text-danger"
                                        >Reason is required.</span
                                      >
                                    </div>
                                  </div>

                                  <div
                                    class="col-sm-12 mb-2"
                                    *ngIf="valuecheck && statuValue == 4"
                                  >
                                    <label class="form-label"
                                      >Visa Document
                                      <span class="text-danger">{{
                                        removestar
                                      }}</span></label
                                    >

                                    <input
                                      type="file"
                                      class="form-control"
                                      (change)="SelectVisa($event)"
                                    />
                                    <div *ngIf="fileName">{{ fileName }}</div>
                                    <div
                                      *ngIf="
                                        ff['fileContent'].errors && isSubmitted
                                      "
                                    >
                                      <span
                                        *ngIf="
                                          ff['fileContent'].errors['required']
                                        "
                                        class="text-danger"
                                        >Please Choose document.
                                      </span>
                                    </div>
                                  </div>
                                  <div class="col-sm-4 mb-2">
                                    <button
                                      type="submit"
                                      class="btn btn-success me-2"
                                    >
                                      Submit
                                    </button>
                                  </div>
                                  <div
                                    class="col-sm-12 mt-3 text-danger"
                                    *ngIf="
                                      visadetailsData?.reason &&
                                      visadetailsData.reason !== 'null' &&
                                      visadetailsData.reason !== ''
                                    "
                                  >
                                    {{ visadetailsData?.reason }}
                                  </div>
                                  <div
                                    class="col-sm-12 mb-2"
                                    *ngIf="
                                      statuValue == 1 ||
                                      visadetailsData?.visaStatus == '' ||
                                      visadetailsData?.visaStatus == null
                                    "
                                  >
                                    <p>
                                      Note:<span class="text-muted fst-italic">
                                        We would request you to save the
                                        application for visa and share the URL
                                        here with us so we can review the
                                        application which will ensure that you
                                        are submitting the correct information
                                        on the visa application that would avoid
                                        or reduce the chance of rejections
                                      </span>
                                    </p>
                                  </div>
                                </form>
                              </div>
                              <button
                              
                              *ngIf="visaFileUrl"
                                type="submit"
                                class="btn btn-danger ms-2"
                                (click)="
                                  downloadPdf(
                                    this.visaFileUrl,
                                    this.visaFileName
                                  )
                                "
                              >
                                Download Admin File
                              </button>
                              <button
                                *ngIf="student_visaFileUrl"
                                type="submit"
                                class="btn btn-danger ms-2"
                                (click)="
                                  downloadPdf(
                                    this.student_visaFileUrl,
                                    this.student_visaFileName
                                  )
                                "
                              >
                                Download student file
                              </button>

                              <p
                                *ngIf="visadetailsData?.isAllGood == true"
                                class="text-success"
                              >
                                Admin has approved visa Inpreparation changes
                              </p>
                            </div>
                          </div>
                        </div>

                        <div *ngIf="IsVisa">
                          <ng-container *ngIf="visaData">
                            <hr />
                            <h4 class="ms-2 fw-600">Visa Updates</h4>
                            <div class="row my-3 mx-2">
                              <div class="col-4">
                                <div
                                  class="fsize-2 fw-600 text-capitalize mb-1 text-info"
                                  *ngIf="visaData.visaStatus == 1"
                                >
                                  Inpreparation
                                </div>

                                <div
                                  class="fsize-2 fw-600 text-capitalize mb-1 text-warning"
                                  *ngIf="visaData.visaStatus == 2"
                                >
                                  Awaiting
                                </div>
                                <div
                                  class="fsize-2 fw-600 text-capitalize mb-1 text-warning"
                                  *ngIf="visaData.visaStatus == 4"
                                >
                                  Refused
                                </div>
                                <div
                                  class="fsize-2 fw-600 text-capitalize mb-1 text-success"
                                  *ngIf="visaData.visaStatus == 3"
                                >
                                  Granted
                                </div>
                                <div
                                  class="fsize-2 fw-600 text-capitalize mb-1 text-info"
                                  *ngIf="visaData.visaStatus == 5"
                                >
                                  Reapplied
                                </div>
                                <div class="doc-label fsize-1 text-capitalize">
                                  Status
                                </div>
                              </div>

                              <div
                                class="col-4"
                                *ngIf="visaData.visaApplicationUrl"
                              >
                                <a
                                  class="fsize-2 text-primary fw-600 pointer"
                                  target="_blank"
                                  href="{{ visaData.visaApplicationUrl }}"
                                  >VIEW</a
                                >
                                <div class="doc-label fsize-1 text-capitalize">
                                  Application Draft
                                </div>
                              </div>
                            </div>

                            <!-- check in visacorrection visaData.visaApplicationUrl || -->
                            <div
                              class="form-group mt-4"
                              *ngIf="
                             visaData.visaApplicationUrl &&
                                visaData.isAllGood == false
                              "
                            >
                              <form
                                [formGroup]="VisaCoreForm"
                                (ngSubmit)="VisaCorectionAdd()"
                              >
                                <div class="row">
                                  <div class="col-sm-12">
                                    <div class="mx-3 mb-2">
                                      <label for="VisaCorrection"
                                        >Visa Application Correction</label
                                      >
                                    </div>
                                    <div class="overflow-auto mx-3">
                                      <input
                                        type="hidden"
                                        formControlName="visaId"
                                      />
                                      <input
                                        type="text"
                                        name="VisaCorrection"
                                        id="VisaCorrection"
                                        placeholder="Enter Corrections"
                                        class="form-control"
                                        formControlName="reason"
                                      />
                                      <div
                                        *ngIf="
                                          fVisaform['reason'].touched &&
                                          fVisaform['reason'].errors
                                        "
                                      >
                                        <span
                                          *ngIf="
                                            fVisaform['reason'].errors[
                                              'required'
                                            ]
                                          "
                                          class="text-danger"
                                          >Please Enter Reason</span
                                        >
                                      </div>
                                    </div>
                                  </div>
                                </div>
                                <div class="row mt-3">
                                  <div class="col-sm-12 mx-3">
                                    <input
                                      type="submit"
                                      class="btn btn-outline-secondary"
                                      value="Send Changes"
                                    />
                                    <input
                                      type="button"
                                      value="All Good!"
                                      (click)="
                                        VisaAllGood(visaData.applicationId);
                                        setmetgroupindex($event)
                                      "
                                      class="btn btn-success mx-2"
                                    />
                                  </div>
                                </div>
                              </form>
                            </div>
                            <div
                              class="text-success"
                              *ngIf="visaData.isAllGood"
                            >
                              Admin has approved Visa Inpreparation changes
                            </div>
                          </ng-container>
                        </div>
                      </div>
                    </div>
                  </perfect-scrollbar>
                </div>
              </div>
            </div>

            <!-- <div class="accordion-item" *ngIf="IsVisa" (click)="setmetgroupindex(6)">
              <h2 class="accordion-header" id="ukvi">
                <button class="accordion-button fw-bold collapsed" type="button" data-bs-toggle="collapse"
                  data-bs-target="#ukvi-details" aria-expanded="false" aria-controls="ukvi-details">
                  UKVI
                </button>
              </h2>
              <div id="ukvi-details" class="accordion-collapse collapse" aria-labelledby="ukvi"
                data-bs-parent="#accordionFlushExample">
                <div class="accordion-body">
                  <div class="modal-tab-scroll">
                    <perfect-scrollbar>
                      <ng-container *ngIf="CasIssueData.length>0">
                        <div class="col-sm-12"
                          *ngIf="CasIssueData[0].casStatusName == 'Active' && CasIssueData[0].casStatus != 6 && IsVisa == true">
                          <button class="btn btn-primary float-end" (click)="openModal(CasReportModal)">Cas
                            Report</button>
                        </div>
                      </ng-container>
                      <div *ngIf="userType =='1' && CasIssueData.length ==0 || IsExpire || isCASWithrow">
                        <form [formGroup]="CsaIssueFileForm" (ngSubmit)="UploadCsaFile()">
                          <div class="row mt-4 mx-0">
                            <div class="col-md-4">
                              <label class="mb-2">CAS Reference Number</label>
                              <input type="text" formControlName="CasNumber" class="form-control"
                                placeholder="i.e. E4G0AE1H42SOJ4" maxlength="14">
                              <div *ngIf="f['CasNumber'].errors">
                                <span *ngIf="isSubmitted && f['CasNumber'].errors['required']"
                                  class="text-danger">Please
                                  enter CAS
                                  number.</span>
                                <span *ngIf="f['CasNumber'].errors['pattern']" class="text-danger">Please enter
                                  14 character for CAS number
                                </span>
                              </div>
                            </div>

                            <div class="col-md-4">
                              <div class="form-group">
                                <label class="mb-2">CAS Certificate</label>
                                <input type="file" formControlName="FileName" class="form-control mb-2"
                                  (change)="changeCsafile($event)">
                                <div *ngIf="!isValidFile">
                                  <span class="text-danger">Please choose valid file
                                    type.</span>
                                </div>
                                <div *ngIf="isFormSubmitted && f['FileName'].errors">
                                  <span *ngIf="f['FileName'].errors['required']" class="text-danger">Please chose
                                    file</span>
                                </div>
                              </div>
                            </div>

                            <div class="col-md-4">
                              <label class="mb-2">CAS Issue Date</label>
                              <input type="date" formControlName="IssueDate" class="form-control" max={{SetDate}}>
                              <div *ngIf="isSubmitted && f['IssueDate'].errors">
                                <span *ngIf="f['IssueDate'].errors['required']" class="text-danger">Please select
                                  IssueDate</span>
                              </div>
                            </div>

                            <div>
                              <button class="btn-transition btn btn-outline-danger me-2" (click)="Datarefrace()"
                                type="button">Cancel</button>

                              <button class="btn btn-success m-2" *ngIf="!IsExpire" type="submit">Issue</button>
                              <button *ngIf="IsExpire" class="btn btn-success m-2" type="submit">Re-Issue</button>
                            </div>
                          </div>
                        </form>
                      </div>
                      <div *ngIf="userType!=='1' ">CAS not Issued</div>

                      <ng-container *ngIf="CasIssueData.length > 0">
                        <table class="table m-2">
                          <thead>
                            <tr>
                              <th>Issue Date</th>
                              <th>UKVI Number</th>
                              <th>Status</th>
                              <th>Action</th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr *ngFor="let CsaIssue of CasIssueData">
                              <td>{{CsaIssue.issueDate | date:'dd/MM/YYYY'}}</td>
                              <td>{{CsaIssue.casNumber}}</td>
                              <td><i *ngIf="!CsaIssue.isExpire && CsaIssue.casStatusName == 'Active'"
                                  class="text-success fw-500 ms-1">
                                  {{CsaIssue.casStatusName}}</i>
                                <i *ngIf="!CsaIssue.isExpire && CsaIssue.casStatusName == 'Withdraw'"
                                  class="text-danger fw-500 ms-1">
                                  {{CsaIssue.casStatusName}}</i>
                                <i *ngIf="CsaIssue.casStatusName == 'Reported'" class="text-danger fw-500 ms-1">
                                  {{CsaIssue.casStatusName}}</i>
                              </td>
                              <td>
                                <div class="me-2 btn-primary btn fsize-1 px-1 py-0">
                                  <i class="fa fa-eye" title="View"
                                    (click)="OpenCASUrlModal(CsaIssue.fileUrl,CsaIssue.applicationId)"></i>
                                </div>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </ng-container>
                    </perfect-scrollbar>
                  </div>
                </div>
              </div>
            </div> -->
            <div class="accordion-item">
              <h2
                class="accordion-header"
                id="airport-arrival"
                (click)="setmetgroupindex(7)"
              >
                <button
                  class="accordion-button fw-bold collapsed"
                  type="button"
                  data-bs-toggle="collapse"
                  data-bs-target="#airport-arrival-details"
                  aria-expanded="false"
                  aria-controls="airport-arrival-details"
                  [disabled]="isAirportArrivalDisabled"
                >
                  Arrival  
                </button>
              </h2>
              <div
                id="airport-arrival-details"
                class="accordion-collapse collapse"
                aria-labelledby="airport-arrival"
                data-bs-parent="#accordionFlushExample"
              >
                <div class="accordion-body">
                  <div class="modal-tab-scroll" *ngIf="airportDetails">
                    <div class="row mx-0">
                      <div class="col-sm-12 mb-4 mt-3">
                        <div class="fsize-2 fw-600">Travel Information</div>
                      </div>
                      <div class="col-sm-4 mb-3">
                        <div class="fw-600 text-nowrap text-capitalize">
                          {{ airportDetails.airlineName }}
                        </div>
                        <div class="text-muted">Airline Name</div>
                      </div>
                      <div class="col-sm-4 mb-3">
                        <div class="fw-600 text-nowrap text-capitalize">
                          {{ airportDetails.flightNumber }}
                        </div>
                        <div class="text-muted">Flight Number</div>
                      </div>
                      <div class="col-sm-4 mb-3">
                        <div class="fw-600 text-nowrap text-capitalize">
                          {{ airportDetails.departureCountryName }}
                        </div>
                        <div class="text-muted">Departure Country</div>
                      </div>
                      <div class="col-sm-4 mb-3">
                        <div class="fw-600 text-nowrap text-capitalize">
                          {{ airportDetails.departureLocationName }}
                        </div>
                        <div class="text-muted">Departure Location</div>
                      </div>
                      <div class="col-sm-4 mb-3">
                        <div class="fw-600 text-nowrap text-capitalize">
                          {{ airportDetails.arrivalCountryName }}
                        </div>
                        <div class="text-muted">Arrival Country</div>
                      </div>
                      <div class="col-sm-4 mb-3">
                        <div class="fw-600 text-nowrap text-capitalize">
                          {{ airportDetails.arrivalLocationName }}
                        </div>
                        <div class="text-muted">Arrival Location</div>
                      </div>
                      <div class="col-sm-4 mb-3">
                        <div class="fw-600 text-nowrap text-capitalize">
                          {{ airportDetails.arrivalDate | date : "dd/MM/yy" }}
                        </div>
                        <div class="text-muted">Arrival Date</div>
                      </div>
                      <div class="col-sm-4 mb-3">
                        <div class="fw-600 text-nowrap text-capitalize">
                          {{ airportDetails.arrivalDate | date : "hh:mm a" }}
                        </div>
                        <div class="text-muted">Arrival Time</div>
                      </div>
                    </div>
                    <div class="row mx-0">
                      <hr />
                      <div class="col-sm-12 mb-4">
                        <div class="fsize-2 fw-600">
                          Accommodation Information
                        </div>
                      </div>
                      <div class="col-sm-4 mb-3">
                        <div class="fw-600 text-nowrap text-capitalize">
                          {{ airportDetails.age }}
                        </div>
                        <div class="text-muted">Age on Arrival</div>
                      </div>
                      <div class="col-sm-8 mb-3">
                        <div class="fw-600 text-nowrap text-capitalize">
                          <ng-container *ngIf="airportDetails.collegeResidence"
                            >Yes</ng-container
                          >
                          <ng-container *ngIf="!airportDetails.collegeResidence"
                            >No</ng-container
                          >
                        </div>
                        <div class="text-muted">
                          Staying in a Devid Game Collage Residence?
                        </div>
                      </div>
                      <div class="col-sm-4 mb-3">
                        <div class="fw-600 text-nowrap text-capitalize">
                          <ng-container *ngIf="airportDetails.boardingStudent"
                            >Yes</ng-container
                          >
                          <ng-container *ngIf="!airportDetails.boardingStudent"
                            >No</ng-container
                          >
                        </div>
                        <div class="text-muted">Boarding Student</div>
                      </div>
                      <div class="col-sm-4 mb-3">
                        <div class="fw-600 text-nowrap text-capitalize">
                          {{ airportDetails.accommodationAddress }}
                        </div>
                        <div class="text-muted">Accommodation Address</div>
                      </div>
                    </div>
                    <div class="row mx-0">
                      <hr />
                      <div class="col-sm-12 mb-4">
                        <div class="fsize-2 fw-600">Collection Information</div>
                      </div>
                      <div class="col-sm-4 mb-3">
                        <div class="fw-600 text-nowrap text-capitalize">
                          <ng-container *ngIf="airportDetails.londonTravel"
                            >Yes</ng-container
                          >
                          <ng-container *ngIf="!airportDetails.londonTravel"
                            >No</ng-container
                          >
                        </div>
                        <div class="text-muted">Required Collection</div>
                      </div>
                      <div class="col-sm-8 mb-3">
                        <div class="fw-600 text-nowrap text-capitalize">
                          {{ airportDetails.travelHubCollectionName }}
                        </div>
                        <div class="text-muted" *ngIf="airportDetails.travelHubCollectionName">
                          Which travel hub do you require collection from?
                        </div>
                      </div>
                      <div class="col-sm-4 mb-3">
                        <div class="fw-600 text-nowrap text-capitalize">
                          <ng-container
                            *ngIf="airportDetails.additionalPassengers == true"
                            >Yes</ng-container
                          >
                          <ng-container
                            *ngIf="airportDetails.additionalPassengers == false"
                            >No</ng-container
                          >
                        </div>
                        <div class="text-muted" *ngIf="airportDetails.additionalPassengers !== null">Additional Passengers</div>
                      </div>
                      <div
                        class="col-sm-8 mb-3"
                        *ngIf="airportDetails.additionalPassengers"
                      >
                        <div class="fw-600 text-nowrap text-capitalize">
                          {{ airportDetails.totalAdditionalPassengers }}
                        </div>
                        <div class="text-muted">
                          Total Additional Passengers
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="accordion-item">
              <h2
                class="accordion-header"
                id="campus-arrival"
                (click)="setmetgroupindex(8)"
              >
                <button
                  class="accordion-button fw-bold collapsed"
                  type="button"
                  data-bs-toggle="collapse"
                  data-bs-target="#campus-arrival-details"
                  aria-expanded="false"
                  aria-controls="campus-arrival-details"
                  [disabled]="isCampusArrivalDisabled"
                >
                  Campus Arrival
                </button>
              </h2>
              <div
                id="campus-arrival-details"
                class="accordion-collapse collapse"
                aria-labelledby="campus-arrival"
                data-bs-parent="#accordionFlushExample"
              >
                <div class="accordion-body">
                  <div class="modal-tab-scroll" *ngIf="campusHistory">
                    <h5 class="my-4 mx-3 fw-bold">Arrival Confirmation</h5>

                    <div
                      class="row mx-0 mt-1 mx-2 border"
                      *ngIf="
                        latestCampus &&
                        (latestCampus.campusStatus == 3 ||
                          latestCampus.campusStatus == 6)
                      "
                    >
                      <div class="col-md-3 my-1 mx-0">
                        <div
                          class="fw-600"
                          *ngIf="latestCampus.campusStatus == 3"
                        >
                          Requested
                        </div>
                        <div
                          class="fw-600 text-offer"
                          *ngIf="latestCampus.campusStatus == 6"
                        >
                          Rescheduled
                        </div>
                        <div class="fw-600" *ngIf="!latestCampus.campusStatus">
                          - - - - -
                        </div>
                        <div class="text-muted">Status</div>
                      </div>
                      <div class="col-md-4 my-1 mx-0">
                        <div
                          class="fw-600 text-nowrap text-capitalize"
                          *ngIf="
                            latestCampus.lastUpdate != null &&
                            latestCampus.lastUpdate != ''
                          "
                        >
                          {{
                            latestCampus.lastUpdate
                              | date : "dd/MM/yyyy hh:mm a"
                          }}
                        </div>
                        <div
                          class="fw-600 text-nowrap text-capitalize"
                          *ngIf="
                            latestCampus.lastUpdate == null &&
                            latestCampus.lastUpdate == ''
                          "
                        >
                          - - - - -
                        </div>
                        <div class="text-muted">Date & Time</div>
                      </div>
                      <div class="col-md-3 my-1 mx-0">
                        <div
                          class="fw-600 text-capitalize"
                          *ngIf="latestCampus.campusName"
                        >
                          {{ application.campusData.campusName }}
                        </div>
                        <div
                          class="fw-600 text-capitalize"
                          *ngIf="
                            latestCampus.campusName == null ||
                            latestCampus.campusName == ''
                          "
                        >
                          - - - - -
                        </div>
                        <div class="text-muted">Arrival Location</div>
                      </div>
                      <div
                        class="col-md-2 my-1 mx-0"
                        *ngIf="
                          (latestCampus.campusStatus == 3 ||
                            latestCampus.campusStatus == 6) &&
                          latestCampus.createdBy != userid
                        "
                      >
                        <div class="d-flex float-end my-2">
                          <div
                            (click)="
                              changeStatus(
                                latestCampus.historyId,
                                application.applicationId,
                                4
                              );
                              setmetgroupindex($event)
                            "
                            class="me-2 btn-success btn fsize-1 px-1 py-0"
                          >
                            <i class="fa fa-check" title="Approve"></i>
                          </div>
                          <div
                            (click)="
                              RejectOrRescheduleConfirm(
                                latestCampus.historyId,
                                application.applicationId
                              );
                              setmetgroupindex($event)
                            "
                            class="me-2 btn-danger btn fsize-1 doc-icon py-0"
                          >
                            <i class="fa fa-times" title="Reject"></i>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div
                      class="row mx-0 mt-1 mx-2"
                      *ngIf="
                        latestCampus &&
                        (latestCampus.campusStatus == 4 ||
                          latestCampus.campusStatus == 5)
                      "
                    >
                      <div class="col-md-4 mb-3">
                        <div
                          class="fw-600 text-offer"
                          *ngIf="latestCampus.campusStatus == 6"
                        >
                          Rescheduled
                        </div>
                        <div
                          class="fw-600 text-success"
                          *ngIf="latestCampus.campusStatus == 3"
                        >
                          Requested
                        </div>
                        <div
                          class="fw-600 text-success"
                          *ngIf="latestCampus.campusStatus == 4"
                        >
                          Approved
                        </div>
                        <div
                          class="fw-600 text-danger"
                          *ngIf="latestCampus.campusStatus == 5"
                        >
                          Rejected
                        </div>
                        <div class="fw-600" *ngIf="!latestCampus.campusStatus">
                          - - - - -
                        </div>
                        <div class="text-muted">Status</div>
                      </div>
                      <div class="col-md-4 mb-3">
                        <div
                          class="fw-600 text-nowrap text-capitalize"
                          *ngIf="
                            latestCampus.lastUpdate != null &&
                            latestCampus.lastUpdate != ''
                          "
                        >
                          {{
                            latestCampus.lastUpdate
                              | date : "dd/MM/yyyy hh:mm a"
                          }}
                        </div>
                        <div
                          class="fw-600 text-nowrap text-capitalize"
                          *ngIf="
                            latestCampus.lastUpdate == null &&
                            latestCampus.lastUpdate == ''
                          "
                        >
                          - - - - -
                        </div>
                        <div class="text-muted">Date & Time</div>
                      </div>
                    </div>

                    <hr />
                    <h5 class="my-4 mx-3 fw-bold">History</h5>
                    <div *ngFor="let app of campusHistory">
                      <div
                        class="row mx-0 mt-1 mx-2"
                        *ngIf="latestCampus && app != latestCampus"
                      >
                        <div class="col-md-4 mb-3">
                          <div
                            class="fw-600 text-offer"
                            *ngIf="app.campusStatus == 6"
                          >
                            Rescheduled
                          </div>
                          <div
                            class="fw-600 text-success"
                            *ngIf="app.campusStatus == 4"
                          >
                            Approved
                          </div>
                          <div
                            class="fw-600 text-danger"
                            *ngIf="app.campusStatus == 5"
                          >
                            Rejected
                          </div>
                          <div class="fw-600" *ngIf="app.campusStatus == 3">
                            Requested
                          </div>
                          <div class="fw-600" *ngIf="!app.campusStatus">
                            - - - - -
                          </div>
                          <div class="text-muted">Status</div>
                        </div>
                        <div class="col-md-4 mb-3">
                          <div
                            class="fw-600 text-nowrap text-capitalize"
                            *ngIf="
                              app.lastUpdate != null && app.lastUpdate != ''
                            "
                          >
                            {{ app.lastUpdate | date : "dd/MM/yyyy hh:mm a" }}
                          </div>
                          <div
                            class="fw-600 text-nowrap text-capitalize"
                            *ngIf="
                              app.lastUpdate == null && app.lastUpdate == ''
                            "
                          >
                            - - - - -
                          </div>
                          <div class="text-muted">Date & Time</div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </mat-tab>
      <mat-tab label="Comments">
        <div class="modal-tab-scroll">
          <div class="chat-wrapper p-1">
            <ng-container *ngFor="let cmt of applicationComments">
              <div
                class="chat-box-wrapper"
                [ngClass]="{
                  'flex-row-reverse': userid == cmt.createdBy,
                  'pt-1': userid != cmt.createdBy
                }"
              >
                <div *ngIf="userid == cmt.createdBy">
                  <div class="avatar-icon-wrapper">
                    <div
                      class="chat-user-right text-uppercase"
                      title="{{ cmt.createdUser.fullName }}"
                    >
                      {{ cmt.createdUser.fullName.substring(0, 2) }}
                    </div>
                  </div>
                </div>
                <div>
                  <div class="d-flex">
                    <div *ngIf="userid != cmt.createdBy">
                      <div class="avatar-icon-wrapper">
                        <div
                          class="chat-user-left text-uppercase"
                          title="{{ cmt.createdUser.fullName }}"
                        >
                          {{ cmt.createdUser.fullName.substring(0, 2) }}
                        </div>
                      </div>
                    </div>
                    <div
                      class="chat-box"
                      [ngClass]="{
                        'right-chat': userid == cmt.createdBy,
                        'left-chat': userid != cmt.createdBy
                      }"
                    >
                      {{ cmt.comment }}
                    </div>
                  </div>
                  <small
                    class="opacity-6"
                    [ngClass]="{ 'float-end': userid == cmt.createdBy }"
                  >
                    {{ cmt.createdDate + "Z" | date : "hh:mm a" }} |
                    {{ getDateFormat(cmt.createdDate, "DD-MM-YYYY") }}
                  </small>
                </div>
              </div>
            </ng-container>
          </div>
        </div>
        <!-- </div> -->
        <div class="modal-footer w-100">
          <div class="d-flex justify-content-between w-100">
            <form class="w-100" [formGroup]="commentForm">
              <div class="mx-2 d-flex">
                <input
                  placeholder="Enter your comments here"
                  type="text"
                  class="form-control-sm form-control"
                  formControlName="comment"
                />
                <button
                  type="submit"
                  class="btn btn-success ms-2"
                  (click)="addNewComment()"
                  [disabled]="!commentForm.valid"
                >
                  Send
                </button>
              </div>
            </form>
          </div>
        </div>
      </mat-tab>
      <mat-tab label="Note">
        <div class="modal-tab-scroll">
          <div class="chat-wrapper p-1">
            <ng-container *ngFor="let cmtnote of applicationNotes">
              <div
                class="chat-box-wrapper"
                [ngClass]="{
                  'flex-row-reverse': userid == cmtnote.createdBy,
                  'pt-1': userid != cmtnote.createdBy
                }"
              >
                <div *ngIf="userid == cmtnote.createdBy">
                  <div class="avatar-icon-wrapper">
                    <div
                      class="chat-user-right text-uppercase"
                      title="{{ cmtnote.createdUser.fullName }}"
                    >
                      {{ cmtnote.createdUser.fullName.substring(0, 2) }}
                    </div>
                  </div>
                </div>
                <div>
                  <div class="d-flex">
                    <div *ngIf="userid != cmtnote.createdBy">
                      <div class="avatar-icon-wrapper">
                        <div
                          class="chat-user-left text-uppercase"
                          title="{{ cmtnote.createdUser.fullName }}"
                        >
                          {{ cmtnote.createdUser.fullName.substring(0, 2) }}
                        </div>
                      </div>
                    </div>
                    <div
                      class="chat-box"
                      [ngClass]="{
                        'right-chat': userid == cmtnote.createdBy,
                        'left-chat': userid != cmtnote.createdBy
                      }"
                    >
                      {{ cmtnote.note }}
                    </div>
                  </div>
                  <small
                    class="opacity-6"
                    [ngClass]="{ 'float-end': userid == cmtnote.createdBy }"
                  >
                    {{ cmtnote.createdDate + "Z" | date : "hh:mm a" }} |
                    {{ getDateFormat(cmtnote.createdDate, "DD-MM-YYYY") }}
                  </small>
                </div>
              </div>
            </ng-container>
          </div>
        </div>
        <!-- </div> -->
        <div class="modal-footer">
          <div class="d-flex justify-content-between w-100">
            <form class="w-100" [formGroup]="noteForm">
              <div class="d-flex">
                <input
                  placeholder="Enter your Notes here"
                  type="text"
                  class="form-control-sm form-control"
                  formControlName="note"
                />
                <button
                  type="submit"
                  class="btn btn-success ms-2"
                  (click)="addNewNote()"
                  [disabled]="!noteForm.valid"
                >
                  Send
                </button>
              </div>
            </form>
          </div>
        </div>

        <!-- </div> -->
        <!-- </div> -->
        <!-- </div> -->
      </mat-tab>
      <mat-tab label="Timeline">
        <div class="modal-tab-scroll">
          <div class="row">
            <div class="col-sm-12 mt-4 scroll-timeline">
              <div
                class="vertical-time-icons vertical-timeline vertical-timeline--animate vertical-timeline--one-column mx-5"
              >
                <!-- <h4 class="fs-5">Application {{application.stageName}} StageId {{application.stageId}}</h4> -->
                <ng-container *ngFor="let application of applicationHistory">
                  <div class="vertical-timeline-item vertical-timeline-element">
                    <div>
                      <span class="vertical-timeline-element-icon bounce-in">
                        <div
                          class="timeline-icon {{
                            application.borderStageClass
                          }}"
                        >
                          <i class="{{ application.stageClass }}"></i>
                        </div>
                      </span>
                      <div class="vertical-timeline-element-content bounce-in">
                        <h4 class="fs-5 fw-600">
                          {{ application.parentStage }}
                          {{ application.stageName }}
                        </h4>
                        <div class="date text-primary">
                          <span class="text-muted">Date:</span>
                          {{ application.createdDate | date : "dd/MM/yyyy" }}
                        </div>
                        <p>{{ application.comment }}</p>
                      </div>
                    </div>
                  </div>
                </ng-container>
              </div>
            </div>
          </div>
        </div>
      </mat-tab>
      <!-- <mat-tab (click)="Todolistpage()" label="My Activity"> </mat-tab> -->
    </mat-tab-group>
  </div>
</ng-template>

<ng-template #documentModel let-modal>
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">{{ modalTitle }}</h4>
    <button
      type="button"
      class="close btn"
      aria-label="Close"
      (click)="modal.dismiss('Cross click')"
    >
      <span aria-hidden="true">
        <h3>×</h3>
      </span>
    </button>
  </div>
  <form [formGroup]="uploadDocumentForm" (ngSubmit)="uploadDocument()">
    <div class="modal-body">
      <div class="row">
        <div class="col-md-12">
          <input type="hidden" formControlName="docId" />
          <input type="hidden" formControlName="applicationId" />
          <input
            type="file"
            formControlName="documentFile"
            class="form-control"
            (change)="convertFileToBase64($event)"
          />
          <div *ngIf="!isValiddOCFile">
            <span class="text-danger">Please choose valid file type.</span>
          </div>
          <div *ngIf="isFormSubmitted && f1['documentFile'].errors">
            <span
              *ngIf="f1['documentFile'].errors['required']"
              class="text-danger"
              >Please chose file</span
            >
          </div>
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <button type="submit" class="btn btn-success">Save</button>
    </div>
  </form>
</ng-template>

<ng-template #DeferOfferrejected let-modal>
  <div class="modal-header border-0">
    <h4 class="modal-title" id="modal-basic-title">Defer Offer Reject</h4>
    <button
      type="button"
      class="close btn"
      aria-label="Close"
      (click)="modal.dismiss()"
    >
      <span aria-hidden="true">×</span>
    </button>
  </div>
  <div class="card-body">
    <div class="row">
      <form [formGroup]="deferOfferStatusForm">
        <div class="col-md-12 mb-3">
          <label class="form-label"
            >Reason <span class="text-danger">*</span></label
          >
          <input
            type="text"
            class="form-control"
            formControlName="reason"
            placeholder="Please enter comment"
          />
          <div *ngIf="fDeferOffer['reason'].errors && issubmitdocstatus">
            <span class="text-danger">Please enter reason</span>
          </div>
        </div>
      </form>
    </div>
  </div>
  <div class="card-footer">
    <div class="row">
      <div class="col-md-12 text-end">
        <button
          type="button"
          class="btn btn-success"
          (click)="UpdateDeferOffer(8)"
        >
          Save
        </button>
      </div>
    </div>
  </div>
</ng-template>
<ng-template #ViewDocumentModal let-modal>
  <div class="modal-header border-0">
    <h4 class="modal-title" id="modal-basic-title">View Document</h4>
    <button
      type="button"
      class="close btn"
      aria-label="Close"
      (click)="modal.dismiss()"
    >
      <span aria-hidden="true">
        <h3>×</h3>
      </span>
    </button>
  </div>
  <div class="modal-body">
    <div class="DocumentMultipleModel">
      <div *ngFor="let DocName of MultipleDocUment">
        <p>
          <b>{{ DocName.fileName }} </b>
        </p>
        <div *ngIf="DocName?.file.split('.').pop() == 'pdf'">
          <iframe
            class="w-100 vh-50 mb-2 mt-2"
            [src]="DocName.fileUrl"
          ></iframe>
        </div>
        <div *ngIf="DocName?.file.split('.').pop() != 'pdf'">
          <img class="w-100 vh-50 mb-2 mt-2" [src]="DocName.fileUrl" />
        </div>
      </div>
      <div *ngIf="MultipleDocUment.length == 0">
        <p class="text-center"><b>No Document</b></p>
      </div>
    </div>
  </div>
  >
  <div class="card-body">
    <div class="row">
      <form>
        <div class="col-md-12 mb-3"></div>
      </form>
    </div>
  </div>
  <div class="card-footer">
    <div class="row">
      <div class="col-md-12 text-end">
        <button type="button" class="btn btn-success me-2" (click)="Approve()">
          Approve
        </button>
        <button type="button" class="btn btn-danger me-2" (click)="Reject()">
          Reject
        </button>
        <button
          type="button"
          class="btn btn-outline-dark"
          (click)="modal.dismiss('Close click')"
        >
          Cancel
        </button>
      </div>
    </div>
  </div>
</ng-template>

<ng-template #ChageStatusDocNote let-modal>
  <div class="modal-header border-0">
    <h4 class="modal-title" id="modal-basic-title">Document Status Change</h4>
    <button
      type="button"
      class="close btn"
      aria-label="Close"
      (click)="modal.dismiss()"
    >
      <span aria-hidden="true">×</span>
    </button>
  </div>
  <div class="card-body">
    <div class="row">
      <form [formGroup]="documentStatusForm">
        <div class="col-md-12 mb-3">
          <label class="form-label"
            >{{ documentlablename }} <span class="text-danger">*</span></label
          >
          <input
            type="text"
            class="form-control"
            formControlName="reason"
            placeholder="Please enter comment"
          />
          <div
            *ngIf="
              documentlablename == 'Reason' &&
              f2['reason'].errors &&
              f2['reason'].touched
            "
          >
            <span *ngIf="f2['reason'].errors['required']" class="text-danger"
              >Reason Field is Required</span
            >
          </div>
        </div>
      </form>
    </div>
  </div>
  <div class="card-footer">
    <div class="row">
      <div class="col-md-12 text-end">
        <button
          type="button"
          class="btn btn-success"
          (click)="updateDocumentStatus()"
        >
          Save
        </button>
      </div>
    </div>
  </div>
</ng-template>

<ng-template #ChageStatusUploadDocumentNote let-modal>
  <div class="modal-header border-0">
    <h4 class="modal-title" id="modal-basic-title">Document Status Change</h4>
    <button
      type="button"
      class="close btn"
      aria-label="Close"
      (click)="modal.dismiss()"
    >
      <span aria-hidden="true">×</span>
    </button>
  </div>
  <div class="card-body">
    <div class="row">
      <form [formGroup]="documentStatusForm">
        <div class="col-md-12 mb-3">
          <label class="form-label"
            >{{ documentlablename }} <span class="text-danger">*</span></label
          >
          <input
            type="text"
            class="form-control"
            formControlName="reason"
            placeholder="Please enter comment"
          />
          <div
            *ngIf="
              documentlablename == 'Reason' &&
              f2['reason'].errors &&
              f2['reason'].touched
            "
          >
            <span *ngIf="f2['reason'].errors['required']" class="text-danger"
              >Reason Field is Required</span
            >
          </div>
        </div>
      </form>
    </div>
  </div>
  <div class="card-footer">
    <div class="row">
      <div class="col-md-12 text-end">
        <button
          type="button"
          class="btn btn-success"
          (click)="updateUploadDocumentStatus()"
        >
          Save
        </button>
      </div>
    </div>
  </div>
</ng-template>

<!--Rename-->

<ng-template #RenameDocumentNote let-modal>
  <div class="modal-header border-0">
    <h4 class="modal-title" id="modal-basic-title">Document Rename</h4>
    <button
      type="button"
      class="close btn"
      aria-label="Close"
      (click)="modal.dismiss()"
    >
      <span aria-hidden="true">×</span>
    </button>
  </div>
  <div class="card-body">
    <div class="row">
      <form [formGroup]="documentRenameForm">
        <div class="col-md-12 mb-3">
          <label class="form-label"
            >File Name <span class="text-danger">*</span></label
          >
          <input
            type="text"
            class="form-control"
            formControlName="filename"
            placeholder="Please enter file name"
          />
          <div *ngIf="frn['filename'].errors && frn['filename'].touched">
            <span *ngIf="frn['filename'].errors['required']" class="text-danger"
              >File Name Field is Required</span
            >
          </div>
        </div>
      </form>
    </div>
  </div>
  <div class="card-footer">
    <div class="row">
      <div class="col-md-12 text-end">
        <button
          type="button"
          class="btn btn-success"
          (click)="RenameDocumentServiceCall()"
        >
          Save
        </button>
      </div>
    </div>
  </div>
</ng-template>

<!--End Rename-->
<ng-template #CasReportModal let-modal>
  <div class="modal-header border-0">
    <h4 class="modal-title" id="modal-basic-title">Cas Report</h4>
    <button
      type="button"
      class="close btn"
      aria-label="Close"
      (click)="modal.dismiss()"
    >
      <span aria-hidden="true">×</span>
    </button>
  </div>
  <div class="card-body">
    <div class="row">
      <form [formGroup]="CasReportForm">
        <div class="col-md-12 mb-3">
          <input type="hidden" formControlName="applicationId" />
          <label class="form-label"
            >Reason <span class="text-danger">*</span></label
          >
          <input
            type="text"
            class="form-control"
            formControlName="reason"
            placeholder="Please Enter Reason"
          />
          <div *ngIf="fCas['reason'].touched && fCas['reason'].errors">
            <span *ngIf="fCas['reason'].errors['required']" class="text-danger"
              >Reason is Required</span
            >
          </div>
        </div>
        <div class="col-md-12 mb-3">
          <label class="form-label"
            >Report Date <span class="text-danger">*</span></label
          >
          <input
            type="date"
            class="form-control"
            formControlName="reportDate"
            max="{{ SetDate }}"
          />
          <div *ngIf="fCas['reportDate'].touched && fCas['reportDate'].errors">
            <span
              *ngIf="fCas['reportDate'].errors['required']"
              class="text-danger"
              >Report date is Required</span
            >
          </div>
        </div>
      </form>
    </div>
  </div>
  <div class="card-footer">
    <div class="row">
      <div class="col-md-12 text-end">
        <button type="button" class="btn btn-success" (click)="CasReportSave()">
          Save
        </button>
      </div>
    </div>
  </div>
</ng-template>

<ng-template #CasUrlModal let-modal>
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">Document Receipt</h4>
    <button
      type="button"
      class="close btn"
      aria-label="Close"
      (click)="modal.dismiss('Cross click')"
    >
      <span aria-hidden="true">
        <h3>×</h3>
      </span>
    </button>
  </div>
  <div class="modal-body">
    <iframe class="w-100 vh-65" [src]="fileUrl"></iframe>
  </div>
  <div class="modal-footer">
    <button
      type="button"
      class="btn btn-secondary"
      (click)="modal.dismiss('Cross click')"
    >
      Close
    </button>
  </div>
</ng-template>

<ng-template #MultipleDocumentUrlModal let-modal>
  <div class="modal-dialog-scrollable" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title" id="modal-basic-title">Document Receipt</h4>
        <button
          type="button"
          class="close btn"
          aria-label="Close"
          (click)="modal.dismiss('Cross click')"
        >
          <span aria-hidden="true">
            <h3>×</h3>
          </span>
        </button>
      </div>
      <div class="modal-body">
        <div class="DocumentMultipleModel">
          <div *ngFor="let DocName of MultipleDocUment">
            <p>
              <b>{{ DocName.fileName }}</b>
            </p>
            <div *ngIf="DocName?.file.split('.').pop() == 'pdf'">
              <iframe
                class="w-100 vh-50 mb-2 mt-2"
                [src]="DocName.fileUrl"
              ></iframe>
            </div>
            <div *ngIf="DocName?.file.split('.').pop() != 'pdf'">
              <img class="w-100 vh-50 mb-2 mt-2" [src]="DocName.fileUrl" />
            </div>
          </div>
          <div *ngIf="MultipleDocUment.length == 0">
            <p class="text-center"><b>No Document</b></p>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <div class="row">
          <div class="col-md-12 text-end">
            <button
              type="button"
              class="btn btn-success me-2"
              (click)="DocchangeStatus(ChageStatusDocNote, 1)"
            >
              Approve
            </button>
            <button
              type="button"
              class="btn btn-danger me-2"
              (click)="DocchangeStatus(ChageStatusDocNote, 0)"
            >
              Reject
            </button>
            <button
              type="button"
              class="btn btn-outline-dark"
              (click)="modal.dismiss('Close click')"
            >
              Cancel
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</ng-template>

<ng-template #DocumentModal let-modal>
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">{{ modalTitle }}</h4>
    <button
      type="button"
      class="close btn"
      aria-label="Close"
      (click)="modal.dismiss('Cross click')"
    >
      <span aria-hidden="true">×</span>
    </button>
  </div>
  <form [formGroup]="documentForm" (ngSubmit)="SaveDocUpload()">
    <div class="modal-body">
      <div class="row">
        <div class="col-md-12 mb-3">
          <input type="hidden" formControlName="documentTypeId" />
          <label class="form-label"
            >Title of document <span class="text-danger">*</span></label
          >
          <input
            type="text"
            formControlName="documentName"
            class="form-control"
            placeholder="Enter Title of document"
          />
          <div *ngIf="isSubmitted && fdoc['documentName'].errors">
            <span
              *ngIf="fdoc['documentName'].errors['required']"
              class="text-danger"
              >Document name is required.</span
            >
          </div>
        </div>
        <div class="col-md-12 mb-3">
          <label class="form-label"
            >Instructions <span class="text-danger">*</span></label
          >
          <input
            type="text"
            class="form-control"
            formControlName="documentDescription"
            placeholder="Enter Instructions"
          />
          <div *ngIf="isSubmitted && fdoc['documentDescription'].errors">
            <span
              *ngIf="fdoc['documentDescription'].errors['required']"
              class="text-danger"
              >Instructions are required.</span
            >
          </div>
        </div>
        <div class="col-md-12 mb-3">
          <label class="form-label"
            >Document Type <span class="text-danger">*</span></label
          >
          <ng-select
            formControlName="documentType"
            bindLabel="documentType"
            placeholder="Select Document Type"
            [searchable]="true"
            [clearable]="true"
            [(ngModel)]="DocTypeval"
          >
            <ng-option [value]="1">Legal </ng-option>
            <ng-option [value]="2">Academic </ng-option>
            <ng-option [value]="3">Legal & Academic </ng-option>
          </ng-select>
          <div *ngIf="isSubmitted && fdoc['documentType'].errors">
            <span
              *ngIf="fdoc['documentType'].errors['required']"
              class="text-danger"
              >Please Choose Document Type.
            </span>
          </div>
        </div>
        <div class="col-md-12 mb-3">
          <label class="form-label">Sample Document</label>
          <input
            type="file"
            class="form-control"
            formControlName="sampleDocumentUrl"
            (change)="changeDocument($event)"
            multiple
          />
          <div *ngIf="fileNameHTML">{{ fileNameHTML }}</div>
          <div *ngIf="isSubmitted && fdoc['sampleDocumentUrl'].errors">
            <span
              *ngIf="fdoc['sampleDocumentUrl'].errors['required']"
              class="text-danger"
              >Please upload document.
            </span>
          </div>
        </div>
        <div class="col-md-12 mb-3">
          <label class="form-label">Form or Letter Document</label>
          <input
            type="file"
            class="form-control"
            formControlName="formOrLetter"
            (change)="changeDocumentforletter($event)"
          />
          <div class="text-danger" *ngIf="!isformLetterValid">
            Please select valid file
          </div>
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <input type="submit" class="btn btn-primary" value="Save" />
    </div>
  </form>
</ng-template>

<ng-template #ChageStatusDocNotes let-modal>
  <div class="modal-header border-0">
    <h4 class="modal-title" id="modal-basic-title">Offer Cancel Reason</h4>
    <button
      type="button"
      class="close btn"
      aria-label="Close"
      (click)="modal.dismiss()"
    >
      <span aria-hidden="true">×</span>
    </button>
  </div>
  <div class="card-body">
    <div class="row">
      <form [formGroup]="documentStatusForms">
        <div class="col-md-12 mb-3">
          <!-- <input type="hiddden" form-control="docId"> -->
          <label class="form-label"
            >Reason<span class="text-danger">*</span></label
          >
          <input
            type="text"
            class="form-control"
            formControlName="reason"
            placeholder="Enter reason"
          />
          <div *ngIf="isReasonFormSubmitted && f3['reason'].errors">
            <span *ngIf="f3['reason'].errors['required']" class="text-danger"
              >Please enter reason</span
            >
          </div>
        </div>
      </form>
    </div>
  </div>
  <div class="card-footer">
    <div class="row">
      <div class="col-md-12 text-end">
        <button type="button" class="btn btn-success" (click)="saveReason()">
          Save
        </button>
      </div>
    </div>
  </div>
</ng-template>

<ng-template #PreviousOfferDetail let-modal>
  <div class="modal-header border-0">
    <h4 class="modal-title" id="modal-basic-title">{{ PreviousOfferName }}</h4>
    <button
      type="button"
      class="close btn"
      aria-label="Close"
      (click)="CanselSendOffer()"
    >
      <span aria-hidden="true">×</span>
    </button>
  </div>
  <div class="card-body">
    <div class="DocumentMultipleModel">
      <div *ngFor="let DocName of PriviousOfferLetterFinalList">
        <p><b>Offer Letter</b></p>
        <div>
          <iframe
            class="w-100 vh-70 mb-2 mt-2"
            [src]="DocName.fileUrl"
          ></iframe>
        </div>
        <!-- <div *ngIf="DocName?.file.split('.').pop() != 'pdf'"><img class="w-100 vh-50 mb-2 mt-2" [src]="DocName.fileUrl"> -->
      </div>
    </div>
    <div *ngIf="PriviousOfferLetterList.length == 0">
      <p class="text-center"><b>No Offer</b></p>
    </div>
  </div>
  <div class="card-footer mt-2 me-2">
    <div class="row">
      <div class="col-md-12 text-end">
        <button
          type="button"
          class="btn btn-outline-danger ms-1"
          (click)="CanselSendOffer()"
        >
          Cancel
        </button>
        <button
          type="submit"
          class="btn btn-success ms-2"
          *ngIf="!IsSaveoffer"
          (click)="SaveSendOffer(0)"
        >
          Send an Offer
        </button>
        <button
          type="submit"
          class="btn btn-primary ms-2"
          (click)="SaveSendOffer(14)"
        >
          Save an Offer
        </button>
        <button
          type="submit"
          class="btn btn-danger ms-2"
          (click)="downloadFile()"
        >
          Download as Word File
        </button>
      </div>
    </div>
  </div>
</ng-template>

<ng-template #ViewOfferLatter let-modal>
  <div class="modal-header border-0">
    <h4 class="modal-title" id="modal-basic-title">Offer Letter</h4>
    <button
      type="button"
      class="close btn"
      aria-label="Close"
      (click)="CanselSendOffer()"
    >
      <span aria-hidden="true">×</span>
    </button>
  </div>
  <div class="card-body">
    <div class="DocumentMultipleModel">
      <div>
        <iframe class="w-100 vh-70 mb-2 mt-2" [src]="Letterfile"></iframe>
      </div>
    </div>
  </div>
  <div class="card-footer mt-2 me-2">
    <div class="row">
      <div class="col-md-12 text-end">
        <button
          type="button"
          class="btn btn-outline-danger ms-1"
          (click)="CanselSendOffer()"
        >
          Cancel
        </button>
      </div>
    </div>
  </div>
</ng-template>

<ng-template #ApplicationStatusChange let-modal>
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">
      Application Status Change
    </h4>
    <button
      type="button"
      class="close btn"
      aria-label="Close"
      (click)="modal.dismiss()"
    >
      <span aria-hidden="true">×</span>
    </button>
  </div>

  <div class="card-body">
    <div class="row">
      <form [formGroup]="campusStatusForm">
        <input type="hidden" formControlName="historyId" />
        <input type="hidden" formControlName="contentId" />
        <input type="hidden" formControlName="statusId" />
        <div class="col-md-12 mb-3">
          <label class="form-label"
            >Arrival Date <span class="text-danger">*</span></label
          >
          <input
            type="date"
            class="form-control"
            placeholder="Arrival Date"
            formControlName="arrivalDate"
            min="{{ SetDate }}"
          />
          <div *ngIf="cf['arrivalDate'].touched && cf['arrivalDate'].errors">
            <span
              *ngIf="cf['arrivalDate'].errors['required']"
              class="text-danger"
              >Please select status.</span
            >
          </div>
        </div>
        <div class="col-md-12 mb-3">
          <label class="form-label"
            >Arrival Time <span class="text-danger">*</span></label
          >
          <input
            type="time"
            class="form-control"
            placeholder="Arrival Date"
            formControlName="arrivalTime"
          />
          <div *ngIf="cf['arrivalTime'].touched && cf['arrivalTime'].errors">
            <span
              *ngIf="cf['arrivalTime'].errors['required']"
              class="text-danger"
              >Please select status.</span
            >
          </div>
        </div>
      </form>
    </div>
  </div>
  <div class="card-footer">
    <div class="row">
      <div class="col-md-12 text-end">
        <button
          type="button"
          class="btn btn-success"
          [disabled]="!campusStatusForm.valid"
          (click)="ChangeCampusStatus()"
        >
          Submit
        </button>
      </div>
    </div>
  </div>
</ng-template>

<ng-template #DocumentRequestModal let-modal>
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">Request Documents</h4>
    <!-- <button class="btn btn-primary float-end my-2 mr-2" (click)="openDocModal(DocumentModal)">Add Document</button> -->
    <button
      type="button"
      (click)="openDocModal(DocumentModal)"
      class="btn-shadow d-inline-flex align-items-center btn btn-primary"
    >
      <fa-icon [icon]="faPlus" class="me-2"></fa-icon>
      Create New 
    </button>
  </div>
  <div class="card-body">
    <div class="row overflow-auto document-request">
      <div class="col-md-12 ps-4" *ngFor="let document of documentList">
        <div
          class="form-check form-check-inline mb-3 d-flex align-items-center"
        >
          <div class="ms-2">
            <input
              type="checkbox"
              class="form-check-input fs-3"
              id="chkdocument{{ document.documentTypeId }}"
              value="{{ document.documentTypeId }}"
              (change)="onChangeDocument($event)"
            />
          </div>
          <div class="ms-1">
            <div class="main-card card">
              <div class="card-body">
                <h5 class="card-title">{{ document.documentName }}</h5>
                <p>{{ document.description }}</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="card-footer">
    <div class="row">
      <div class="col-md-12 text-end">
        <button
          type="button"
          class="btn btn-outline-dark me-3"
          aria-label="Close"
          (click)="modal.dismiss()"
        >
          Cancel
        </button>

        <button
          type="button"
          class="btn btn-success"
          [disabled]="selectedDocumentList.length == 0"
          (click)="DocumentRequest()"
        >
          Request
        </button>
      </div>
    </div>
  </div>
</ng-template>

<ng-template #DocumentUploadView let-modal>
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">{{ DocumentName }}</h4>
    <button
      type="button"
      class="close btn"
      aria-label="Close"
      (click)="modal.dismiss('Cross click')"
    >
      <span aria-hidden="true">
        <h3>×</h3>
      </span>
    </button>
  </div>
  <div class="modal-body">
    <div class="text-muted mt-2 mb-2">
      <p>
        Note :- Required file formats are .jpg , .jfif ,.png and .pdf only. The
        file size must be lower than 2 MB each.
      </p>
    </div>
    <div class="mt-2 mb-2">
      <form
        [formGroup]="uploadMultipleDocumentForm"
        (ngSubmit)="uploadMultipleDocument()"
      >
        <div class="Docmodal-body ps-2">
          <div class="row">
            <div class="col-md-12 pb-0">
              <input type="hidden" formControlName="docId" />
              <input type="hidden" formControlName="applicationId" />
              <label class="form-label mt-2"
                >Choose Document <span class="text-danger">*</span></label
              >
              <input
                type="file"
                formControlName="documentFile"
                class="form-control"
                (change)="convertFileToBase64($event)"
              />
              <div *ngIf="!isValidFile">
                <span class="text-danger mb-4"
                  >Please choose valid file type.</span
                >
              </div>
              <div *ngIf="fuploadsdoc['documentFile'].error && isFormSubmitted">
                <span class="text-danger mb-4">Please choose file</span>
              </div>
              <div class="d-flex card-footer justify-content-between pe-0">
                <div>
                  <button
                    type="button"
                    class="btn btn-outline-danger ms-1"
                    (click)="resetUploadDocumentform()"
                  >
                    Clear
                  </button>
                  <button type="submit" class="btn btn-success ms-2">
                    submit
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </form>

      <div class="d-flex card-footer justify-content-between">
        <div>
          <!-- <button type="button" (click)="NewDocUp()" class="btn btn-success m-2 text-start">Add New File</button> -->
        </div>
        <div>
          <button
            type="button"
            class="btn btn-outline-danger ms-1"
            (click)="modal.dismiss('Cross click')"
          >
            Close
          </button>
          <!-- <button type="submit" class="btn btn-success ms-2">submit</button> -->
        </div>
      </div>
    </div>
  </div>
</ng-template>
<ng-template #DocumentUploadView1 let-modal>
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">{{ DocumentName }}</h4>
    <button
      type="button"
      class="close btn"
      aria-label="Close"
      (click)="modal.dismiss('Cross click')"
    >
      <span aria-hidden="true">
        <h3>×</h3>
      </span>
    </button>
  </div>
  <div class="modal-body">
    <div class="mt-2 mb-2">
      <!-- <div [innerHTML]="testcode"></div> -->
      <div class="mb-4" *ngIf="SubDocumentList?.length > 0">
        <hr class="mt-0" *ngIf="DocumentSatus != 3" />
        <label class="mb-2" *ngIf="IsUploadMe"
          ><b>Previously Uploaded file</b></label
        >
        <!-- <label *ngIf="DocumentSatus == 3" class="mb-2"> Your Uploaded file</label> -->
        <div *ngFor="let document of SubDocumentList">
          <div
            class="d-flex justify-content-between mt-2 p-2 align-items-center border rounded"
            *ngIf="document.isUploadByMe"
          >
            <div>
              <label>{{ document.document_Name }} </label
              ><span class="text-success" *ngIf="document.documentStatus == 3"
                >- Approved</span
              >
              <span class="text-success" *ngIf="document.documentStatus == 6"
                >- Physical Approved</span
              ><span class="text-danger" *ngIf="document.documentStatus == 4"
                >- Rejected (Reason:-{{ document.reason }})</span
              >
              <span class="text-danger" *ngIf="document.documentStatus == 7"
                >- Physical Rejected (Reason:-{{ document.reason }})</span
              ><span class="text-warning" *ngIf="document.documentStatus == 2"
                >- Awaiting</span
              >
            </div>
            <div>
              <!-- <button title="Upload" class="text-end btn btn-warning ms-2"
                *ngIf="document.documentStatus == 4 || document.documentStatus == 7">
                <i class="fa fa-upload" style="color: white;"
                  (click)="openReuploadModal(documentModel,document.docId,document.uploadDocId,0)"></i>
              </button> -->
              <!-- <button title="Verifry" class="text-end btn btn-success ms-2"
                *ngIf="OnboardStatus==4 && document.documentStatus!=6 && document.documentStatus!=7"
                (click)="UploadDocchangeStatus(ChageStatusUploadDocumentNote,document.uploadDocId,6)">
                <i class="fa fa-check"></i>
              </button>
              <button title="Un-Verified" class="text-end btn btn-danger ms-2"
                *ngIf="OnboardStatus==4 && document.documentStatus!=6 && document.documentStatus!=7"
                (click)="UploadDocchangeStatus(ChageStatusUploadDocumentNote,document.uploadDocId,7)">
                <i class="fa fa-times"></i>
              </button> -->
              <!-- <button title="View" class="text-end btn btn-primary ms-2" (click)="OpenCASUrlModal(document.docPath)"><i
                  class="fa fa-eye"></i></button>
              <button class="text-end btn btn-success ms-2" title="Download" (click)="downloadForm(document.docPath)"><i
                  class="fa fa-download"></i></button>
              <button title="Print" class="text-end btn btn-light ms-2" (click)="printPage(document.docPath)"><i
                  class="fa fa-print"></i></button>
              <button class="text-end btn btn-danger ms-2" title="Delete" *ngIf="document.isUploadByMe"
                (click)="DeleteDocument(document.uploadDocId)"><i class="fa fa-trash"></i></button> -->

              <button
                title="Rename"
                class="text-end btn btn-primary ms-2"
                (click)="RenameDocument(document.uploadDocId)"
              >
                <i class="fa fa-pencil"></i>
              </button>
              <button
                title="Approve"
                class="text-end btn btn-success ms-2"
                *ngIf="document.documentStatus == 2"
                (click)="
                  UploadDocchangeStatus(
                    ChageStatusUploadDocumentNote,
                    document.uploadDocId,
                    3
                  )
                "
              >
                <i class="fa fa-check"></i>
              </button>
              <button
                title="Physical Verify"
                class="text-end btn btn-success ms-2"
                *ngIf="
                  OnboardStatus == 4 &&
                  document.documentStatus != 6 &&
                  document.documentStatus != 7
                "
                (click)="
                  UploadDocchangeStatus(
                    ChageStatusUploadDocumentNote,
                    document.uploadDocId,
                    6
                  )
                "
              >
                <i class="fa fa-check"></i>
              </button>
              <button
                title="Physical Un-Verified"
                class="text-end btn btn-danger ms-2"
                *ngIf="
                  OnboardStatus == 4 &&
                  document.documentStatus != 6 &&
                  document.documentStatus != 7
                "
                (click)="
                  UploadDocchangeStatus(
                    ChageStatusUploadDocumentNote,
                    document.uploadDocId,
                    7
                  )
                "
              >
                <i class="fa fa-times"></i>
              </button>
              <button
                title="Reject"
                class="text-end btn btn-danger ms-2"
                *ngIf="
                  document.documentStatus == 2 || document.documentStatus == 3
                "
                (click)="
                  UploadDocchangeStatus(
                    ChageStatusUploadDocumentNote,
                    document.uploadDocId,
                    4
                  )
                "
              >
                <i class="fa fa-times"></i>
              </button>
              <button
                title="Upload"
                class="text-end btn btn-warning ms-2"
                *ngIf="
                  document.documentStatus == 4 || document.documentStatus == 7
                "
                (click)="
                  openReuploadModal(
                    documentModel,
                    document.docId,
                    document.uploadDocId,
                    0
                  )
                "
              >
                <i class="fa fa-upload" style="color: white"></i>
              </button>
              <button
                title="View"
                class="text-end btn btn-primary ms-2"
                (click)="OpenCASUrlModal(document.docPath)"
              >
                <i class="fa fa-eye"></i>
              </button>
              <button
                title="Download"
                class="text-end btn btn-success ms-2"
                (click)="downloadForm(document.docPath, document.document_Name)"
              >
                <i class="fa fa-download"></i>
              </button>
              <button
                title="Print"
                class="text-end btn btn-light ms-2"
                (click)="printPage(document.docPath)"
              >
                <i class="fa fa-print"></i>
              </button>
              <button
                class="text-end btn btn-danger ms-2"
                title="Delete"
                *ngIf="
                  (DocumentSatus != 3 && document.isUploadByMe) ||
                  document.documentStatus == 3 ||
                  document.documentStatus == 6
                "
                (click)="DeleteDocument(document.uploadDocId)"
              >
                <i class="fa fa-trash"></i>
              </button>
            </div>
          </div>
        </div>
        <label class="mt-4" *ngIf="IsNotUploadMe"
          ><b>Student's Uploaded file</b></label
        >
        <!-- <label class="mt-4" *ngIf="DocumentSatus == 3">Student Approved file</label> -->
        <div *ngFor="let document of SubDocumentList">
          <div
            class="d-flex justify-content-between mt-2 p-2 align-items-center border rounded"
            *ngIf="!document.isUploadByMe"
          >
            <div>
              <label>{{ document.document_Name }}</label>
              <span class="text-success" *ngIf="document.documentStatus == 3"
                >- Approved</span
              >
              <span class="text-success" *ngIf="document.documentStatus == 6"
                >- Physical Approved</span
              ><span class="text-danger" *ngIf="document.documentStatus == 4"
                >- Rejected (Reason:-{{ document.reason }})</span
              >
              <span class="text-danger" *ngIf="document.documentStatus == 7"
                >- Physical Rejected (Reason:-{{ document.reason }})</span
              ><span class="text-warning" *ngIf="document.documentStatus == 2"
                >- Awaiting</span
              >
            </div>
            <div>
              <button
              title="Rename"
              class="text-end btn btn-primary ms-2"
              (click)="RenameDocument(document.uploadDocId)"
            >
              <i class="fa fa-pencil"></i>
            </button>
              <button
                title="Approve"
                class="text-end btn btn-success ms-2"
                *ngIf="document.documentStatus == 2"
                (click)="
                  UploadDocchangeStatus(
                    ChageStatusUploadDocumentNote,
                    document.uploadDocId,
                    3
                  )
                "
              >
                <i class="fa fa-check"></i>
              </button>
              <button
                title="Physical Verify"
                class="text-end btn btn-success ms-2"
                *ngIf="
                  OnboardStatus == 4 &&
                  document.documentStatus != 6 &&
                  document.documentStatus != 7
                "
                (click)="
                  UploadDocchangeStatus(
                    ChageStatusUploadDocumentNote,
                    document.uploadDocId,
                    6
                  )
                "
              >
                <i class="fa fa-check"></i>
              </button>
              <button
                title="Physical Un-Verified"
                class="text-end btn btn-danger ms-2"
                *ngIf="
                  OnboardStatus == 4 &&
                  document.documentStatus != 6 &&
                  document.documentStatus != 7
                "
                (click)="
                  UploadDocchangeStatus(
                    ChageStatusUploadDocumentNote,
                    document.uploadDocId,
                    7
                  )
                "
              >
                <i class="fa fa-times"></i>
              </button>
              <button
                title="Reject"
                class="text-end btn btn-danger ms-2"
                *ngIf="
                  document.documentStatus == 2 || document.documentStatus == 3
                "
                (click)="
                  UploadDocchangeStatus(
                    ChageStatusUploadDocumentNote,
                    document.uploadDocId,
                    4
                  )
                "
              >
                <i class="fa fa-times"></i>
              </button>
              <button
                title="Upload"
                class="text-end btn btn-warning ms-2"
                *ngIf="
                  document.documentStatus == 4 || document.documentStatus == 7
                "
                (click)="
                  openReuploadModal(
                    documentModel,
                    document.docId,
                    document.uploadDocId,
                    0
                  )
                "
              >
                <i class="fa fa-upload" style="color: white"></i>
              </button>
              <!-- <button class="text-end btn btn-success ms-2" *ngIf="DocumentSatus == 3 && document.documentStatus == 3"
                (click)="UploadDocchangeStatus(ChageStatusUploadDocumentNote,document.uploadDocId,6)">
                <i class="fa fa-check" title="Physical Approve"></i>
              </button>
              <button class="text-end btn btn-danger ms-2" *ngIf="DocumentSatus == 3 && document.documentStatus == 3"
                (click)="UploadDocchangeStatus(ChageStatusUploadDocumentNote,document.uploadDocId,7)">
                <i class="fa fa-times" title="Physical Reject"></i>
              </button> -->
              <button
                title="View"
                class="text-end btn btn-primary ms-2"
                (click)="OpenCASUrlModal(document.docPath)"
              >
                <i class="fa fa-eye"></i>
              </button>
              <button
                title="Download"
                class="text-end btn btn-success ms-2"
                (click)="downloadForm(document.docPath, document.document_Name)"
              >
                <i class="fa fa-download"></i>
              </button>
              <button
                title="Print"
                class="text-end btn btn-light ms-2"
                (click)="printPage(document.docPath)"
              >
                <i class="fa fa-print"></i>
              </button>
              <button
                class="text-end btn btn-danger ms-2"
                title="Delete"
                *ngIf="
                  (DocumentSatus != 3 && document.isUploadByMe) ||
                  document.documentStatus == 3 ||
                  document.documentStatus == 6
                "
                (click)="DeleteDocument(document.uploadDocId)"
              >
                <i class="fa fa-trash"></i>
              </button>
              <!-- <button class="text-end btn btn-danger ms-2"
                *ngIf="DocumentSatus != 3 && document.isUploadByMe || document.documentStatus == 3 || document.documentStatus == 6 || document.documentStatus == 7"
                (click)="DeleteDocument(document.uploadDocId)"><i class="fa fa-trash"></i></button> -->
            </div>
          </div>
        </div>
      </div>

      <div class="d-flex card-footer justify-content-between">
        <div>
          <!-- <button type="button" (click)="NewDocUp()" class="btn btn-success m-2 text-start">Add New File</button> -->
        </div>
        <div>
          <button
            type="button"
            class="btn btn-outline-danger ms-1"
            (click)="modal.dismiss('Cross click')"
          >
            Close
          </button>
          <!-- <button type="submit" class="btn btn-success ms-2">submit</button> -->
        </div>
      </div>
    </div>
  </div>
</ng-template>

<ng-template #PhysicalApprovReject let-modal>
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">{{ DocumentName }}</h4>
    <button
      type="button"
      class="close btn"
      aria-label="Close"
      (click)="modal.dismiss('Cross click')"
    >
      <span aria-hidden="true">
        <h3>×</h3>
      </span>
    </button>
  </div>
  <div class="modal-body">
    <div class="mt-2 mb-2">
      <div class="mb-4" *ngIf="SubDocumentList?.length > 0">
        <!-- <hr class="mt-0" *ngIf="DocumentSatus != 3"> -->
        <label class="mb-2" *ngIf="IsUploadMe"><b>Your Uploaded file</b></label>
        <!-- <label *ngIf="DocumentSatus == 3" class="mb-2"> Your Uploaded file</label> -->
        <div *ngFor="let document of SubDocumentList">
          <div
            class="d-flex justify-content-between mt-2 p-2 align-items-center border rounded"
            *ngIf="document.isUploadByMe"
          >
            <div>
              <label>{{ document.document_Name }}</label
              ><span class="text-success" *ngIf="document.documentStatus == 3"
                >- Approved</span
              >
              <span class="text-success" *ngIf="document.documentStatus == 6"
                >- Physical Approved</span
              ><span class="text-danger" *ngIf="document.documentStatus == 4"
                >- Rejected (Reason:-{{ document.reason }})</span
              >
              <span class="text-danger" *ngIf="document.documentStatus == 7"
                >- Physical Rejected (Reason:-{{ document.reason }})</span
              ><span class="text-warning" *ngIf="document.documentStatus == 2"
                >- Awaiting</span
              >
            </div>
            <div>
              <button
                title="Verified"
                class="text-end btn btn-success ms-2"
                *ngIf="
                  document.documentStatus == 2 ||
                  document.documentStatus == 3 ||
                  document.documentStatus == 1 ||
                  document.documentStatus == 5
                "
                (click)="
                  UploadDocchangeStatus(
                    ChageStatusUploadDocumentNote,
                    document.uploadDocId,
                    6
                  )
                "
              >
                <i class="fa fa-check"></i>
              </button>
              <button
                title="Un-Verified"
                class="text-end btn btn-danger ms-2"
                *ngIf="
                  document.documentStatus == 2 ||
                  document.documentStatus == 3 ||
                  document.documentStatus == 1 ||
                  document.documentStatus == 5
                "
                (click)="
                  UploadDocchangeStatus(
                    ChageStatusUploadDocumentNote,
                    document.uploadDocId,
                    7
                  )
                "
              >
                <i class="fa fa-times"></i>
              </button>
              <button
                title="Upload"
                class="text-end btn btn-warning ms-2"
                *ngIf="
                  document.documentStatus == 4 || document.documentStatus == 7
                "
              >
                <i
                  class="fa fa-upload"
                  style="color: white"
                  (click)="
                    openReuploadModal(
                      documentModel,
                      document.docId,
                      document.uploadDocId,
                      1
                    )
                  "
                ></i>
              </button>
              <button
                title="view"
                class="text-end btn btn-primary ms-2"
                (click)="OpenCASUrlModal(document.docPath)"
              >
                <i class="fa fa-eye"></i>
              </button>
              <button
                title="Download"
                class="text-end btn btn-success ms-2"
                (click)="downloadForm(document.docPath)"
              >
                <i class="fa fa-download"></i>
              </button>
              <button
                class="text-end btn btn-danger ms-2"
                *ngIf="DocumentSatus != 3 && document.isUploadByMe"
                (click)="DeleteDocument(document.uploadDocId)"
              >
                <i class="fa fa-trash"></i>
              </button>
            </div>
          </div>
        </div>
        <label *ngIf="IsNotUploadMe" class="mt-4"
          ><b>Student's Uploaded file</b></label
        >
        <!-- <label class="mt-4" *ngIf="DocumentSatus == 3">Student Approved file</label> -->
        <div *ngFor="let document of SubDocumentList">
          <div
            class="d-flex justify-content-between mt-2 p-2 align-items-center border rounded"
            *ngIf="!document.isUploadByMe"
          >
            <div>
              <label>{{ document.document_Name }}</label>
              <span class="text-success" *ngIf="document.documentStatus == 3"
                >- Approved</span
              >
              <span class="text-success" *ngIf="document.documentStatus == 6"
                >- Physical Approved</span
              ><span class="text-danger" *ngIf="document.documentStatus == 4"
                >- Rejected (Reason:-{{ document.reason }})</span
              >
              <span class="text-danger" *ngIf="document.documentStatus == 7"
                >- Physical Rejected (Reason:-{{ document.reason }})</span
              ><span class="text-warning" *ngIf="document.documentStatus == 2"
                >- Awaiting</span
              >
            </div>
            <div>
              <button
                title="Physical Verify"
                class="text-end btn btn-success ms-2"
                *ngIf="
                  document.documentStatus == 2 ||
                  document.documentStatus == 3 ||
                  document.documentStatus == 1 ||
                  document.documentStatus == 5
                "
                (click)="
                  UploadDocchangeStatus(
                    ChageStatusUploadDocumentNote,
                    document.uploadDocId,
                    6
                  )
                "
              >
                <i class="fa fa-check"></i>
              </button>
              <button
                title="Physical Un-Verified"
                class="text-end btn btn-danger ms-2"
                *ngIf="
                  document.documentStatus == 2 ||
                  document.documentStatus == 3 ||
                  document.documentStatus == 1 ||
                  document.documentStatus == 5
                "
                (click)="
                  UploadDocchangeStatus(
                    ChageStatusUploadDocumentNote,
                    document.uploadDocId,
                    7
                  )
                "
              >
                <i class="fa fa-times"></i>
              </button>
              <button
                title="Upload"
                (click)="
                  openReuploadModal(
                    documentModel,
                    document.docId,
                    document.uploadDocId,
                    1
                  )
                "
                class="text-end btn btn-warning ms-2"
                *ngIf="
                  document.documentStatus == 4 || document.documentStatus == 7
                "
              >
                <i class="fa fa-upload" style="color: white"></i>
              </button>
              <button
                title="View"
                class="text-end btn btn-primary ms-2"
                (click)="OpenCASUrlModal(document.docPath)"
              >
                <i class="fa fa-eye"></i>
              </button>
              <button
                title="Download"
                class="text-end btn btn-success ms-2"
                (click)="downloadForm(document.docPath, document.document_Name)"
              >
                <i class="fa fa-download"></i>
              </button>
              <button
                class="text-end btn btn-danger ms-2"
                *ngIf="
                  (DocumentSatus != 3 && document.isUploadByMe) ||
                  document.documentStatus == 3 ||
                  document.documentStatus == 6
                "
                (click)="DeleteDocument(document.uploadDocId)"
                title="Delete"
              >
                <i class="fa fa-trash"></i>
              </button>

              <!-- <button class="text-end btn btn-danger ms-2"
                *ngIf="DocumentSatus != 3 && document.isUploadByMe || DocumentSatus != 3 && document.documentStatus == 3"
                (click)="DeleteDocument(document.uploadDocId)"><i class="fa fa-trash"></i></button> -->
            </div>
          </div>
        </div>
      </div>

      <div class="d-flex card-footer justify-content-between">
        <div>
          <!-- <button type="button" (click)="NewDocUp()" class="btn btn-success m-2 text-start">Add New File</button> -->
        </div>
        <div>
          <button
            type="button"
            class="btn btn-outline-danger ms-1"
            (click)="modal.dismiss('Cross click')"
          >
            Close
          </button>
          <!-- <button type="submit" class="btn btn-success ms-2">submit</button> -->
        </div>
      </div>
    </div>
  </div>
</ng-template>

<ng-template #AddConditionModal let-modal>
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">Add Condition</h4>
    <button
      type="button"
      class="close btn"
      aria-label="Close"
      (click)="modal.dismiss()"
    >
      <span aria-hidden="true">×</span>
    </button>
  </div>

  <div class="card-body">
    <div class="row">
      <perfect-scrollbar
        [autoPropagation]="true"
        class="scroll-container"
        [config]="config"
        [scrollIndicators]="true"
        style="max-width: 600px; max-height: 80vh"
      >
        <form [formGroup]="AddConditionForm">
          <input type="hidden" formControlName="offerid" />
          <input type="hidden" formControlName="isFullFil" />

          <div class="col-md-12 ps-2" *ngFor="let condition of conditionList">
            <div class="form-check form-check-inline d-flex align-items-center">
              <div class="ms-2">
                <input
                  type="checkbox"
                  class="form-check-input fs-5"
                  id="chkdocument{{ condition.conditonId }}"
                  value="{{ condition.conditonId }}"
                  [checked]="isChecked(condition.conditonId)"
                  (change)="onChangeCondition($event)"
                />
              </div>
              <div class="ms-1 pt-3">
                <p>{{ condition.condtion }}</p>
              </div>
            </div>
            <!-- <label for="chkdocument{{document.documenTypeId}}" class="form-check-label">{{document.documentName}}</label> -->
          </div>
          <div class="col-md-12 mb-3">
            <div *ngIf="fc['conditions'].touched && fc['conditions'].errors">
              <span
                *ngIf="fc['conditions'].errors['required']"
                class="text-danger"
                >Please select condition</span
              >
            </div>
          </div>
        </form>
      </perfect-scrollbar>
    </div>
  </div>
  <div class="card-footer">
    <div class="row">
      <div class="col-md-12 text-end">
        <button
          type="button"
          class="btn btn-success"
          disabled
          *ngIf="IsCoditionoffer"
          (click)="saveOfferCondition()"
        >
          Submit
        </button>
        <button
          type="button"
          class="btn btn-success"
          [disabled]="!AddConditionForm.valid"
          *ngIf="!IsCoditionoffer"
          (click)="saveOfferCondition()"
        >
          Submit
        </button>
      </div>
    </div>
  </div>
</ng-template>
<ng-template #AddConditionOfferModal let-modal>
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">Add Condition</h4>
    <button
      type="button"
      class="close btn"
      aria-label="Close"
      (click)="modal.dismiss()"
    >
      <span aria-hidden="true">×</span>
    </button>
  </div>

  <div class="card-body">
    <div class="row">
      <perfect-scrollbar
        [autoPropagation]="true"
        class="scroll-container"
        [config]="config"
        [scrollIndicators]="true"
        style="max-width: 600px; max-height: 80vh"
      >
        <div class="col-md-12 ps-2" *ngFor="let condition of AllconditionList">
          <div class="form-check form-check-inline d-flex align-items-center">
            <div class="ms-2">
              <input
                type="checkbox"
                class="form-check-input fs-5"
                id="chkdocument{{ condition.conditonId }}"
                value="{{ condition.conditonId }}"
                [checked]="isoffercodition(condition.conditonId)"
                (change)="onChangeOfferCondition($event)"
              />
            </div>
            <div class="ms-1 pt-3">
              <p>{{ condition.condtion }}</p>
            </div>
          </div>
        </div>
      </perfect-scrollbar>
    </div>
  </div>
  <div class="card-footer">
    <div class="row">
      <div class="col-md-12 text-end">
        <button type="button" class="btn btn-success" (click)="modal.dismiss()">
          Submit
        </button>
      </div>
    </div>
  </div>
</ng-template>
<ng-template #OfferConditionModal let-modal>
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">Offer Condition</h4>
    <button
      type="button"
      class="close btn"
      aria-label="Close"
      (click)="modal.dismiss()"
    >
      <span aria-hidden="true">×</span>
    </button>
  </div>
  <!-- <form [formGroup]="fullfilForm" (ngSubmit)="SaveFullfil()"> -->
  <div class="card-body">
    <div class="row">
      <div class="col-md-12 mb-3" *ngFor="let condition of offerConditions">
        <input
          type="checkbox"
          *ngIf="condition.isFullFil"
          checked
          id="oc_{{ condition.conditionOfferId }}"
        />
        <input
          type="checkbox"
          *ngIf="!condition.isFullFil"
          id="oc_{{ condition.conditionOfferId }}"
        /><label
          class="ms-2"
          for="oc_{{ condition.conditionOfferId }}"
          value="{{ condition.conditionOfferId }}"
          >{{ condition.condtion }}</label
        >
      </div>
    </div>
  </div>
  <div class="card-footer">
    <div class="row">
      <div class="col-md-12 text-end">
        <button
          type="button"
          class="btn btn-danger me-2"
          (click)="modal.dismiss()"
        >
          Close
        </button>
        <button type="submit" class="btn btn-success" (click)="SaveFullfil()">
          Save
        </button>
      </div>
    </div>
  </div>
  <!-- </form> -->
</ng-template>

<ng-template #ReceiptView let-modal>
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">{{ modalTitle }}</h4>
    <button
      type="button"
      class="close btn"
      aria-label="Close"
      (click)="modal.dismiss('Cross click')"
    >
      <span aria-hidden="true">
        <h3>×</h3>
      </span>
    </button>
  </div>
  <div class="modal-body">
    <div class="mt-2 mb-2">
      <div class="mb-4" *ngIf="PaymentReceipts?.length > 0">
        <div *ngFor="let receipt of PaymentReceipts">
          <div
            class="d-flex justify-content-between mt-2 p-2 align-items-center border rounded"
          >
            <div>
              <label>{{ receipt.receiptName }}</label>
              <span class="text-success" *ngIf="receipt.status == 1"
                >- Paid</span
              >
              <span class="text-danger" *ngIf="receipt.status == 2"
                >- Rejected (Reason:-{{ receipt.reason }})</span
              >
              <span class="text-warning" *ngIf="receipt.status == 0"
                >- Unverify</span
              >
            </div>
            <div>
              <!-- <button class="text-end btn btn-warning ms-2"
                *ngIf="document.documentStatus == 4 || document.documentStatus == 7">
                <i class="fa fa-upload" title="Upload" style="color: white;"
                  (click)="openReuploadModal(documentModel,document.docId,document.uploadDocId,0)"></i>
              </button>
              <button class="text-end btn btn-primary ms-2" (click)="OpenCASUrlModal(document.docPath)"><i
                  class="fa fa-eye" title="View"></i></button>-->
              <button
                class="text-end btn btn-success ms-2"
                (click)="downloadForm(receipt.paymentReceiptUrl)"
              >
                <i class="fa fa-download" title="Download"></i>
              </button>
              <!--<button class="text-end btn btn-light ms-2" (click)="printPage(document.docPath)"><i class="fa fa-print"
                  title="Print"></i></button>
              <button class="text-end btn btn-danger ms-2" *ngIf="document.isUploadByMe"
                (click)="DeleteDocument(document.uploadDocId)"><i class="fa fa-trash" title="Delete"></i></button> -->
            </div>
          </div>
        </div>
      </div>

      <div class="d-flex card-footer justify-content-between">
        <div></div>
        <div>
          <button
            type="button"
            class="btn btn-outline-danger ms-1"
            (click)="modal.dismiss('Cross click')"
          >
            Close
          </button>
          <!-- <button type="submit" class="btn btn-success ms-2">submit</button> -->
        </div>
      </div>
    </div>
  </div>
</ng-template>
<ng-template #UploadReceiptModal let-modal>
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">Upload Receipt</h4>
    <button
      type="button"
      class="close btn"
      aria-label="Close"
      (click)="modal.dismiss('Cross click')"
    >
      <span aria-hidden="true">
        <h3>×</h3>
      </span>
    </button>
  </div>
  <form
    [formGroup]="UploadDepositReceiptForm"
    (ngSubmit)="uploadDepositeReceipt()"
  >
    <div class="modal-body">
      <div class="mt-2 mb-2">
        <div class="col-sm-12 mb-2">
          <label class="form-label">
            Amount <span class="text-danger">*</span>
          </label>
          <input
            type="text"
            formControlName="amount"
            class="form-control"
            placeholder="Enter Deposited Amount"
          />
          <div *ngIf="fDeposit['amount'].touched && fDeposit['amount'].errors">
            <span
              *ngIf="fDeposit['amount'].errors['required']"
              class="text-danger"
              >Amount is required.</span
            >
          </div>
        </div>
        <div class="col-sm-12 mb-2">
          <label class="form-label">
            Upload Fee Receipt <span class="text-danger">*</span>
          </label>
          <input
            type="file"
            class="form-control"
            formControlName="dReceipt"
            (change)="convertFileToBase64($event)"
          />
          <div
            *ngIf="fDeposit['dReceipt'].touched && fDeposit['dReceipt'].errors"
          >
            <span
              *ngIf="fDeposit['dReceipt'].errors['required']"
              class="text-danger"
              >Receipt is required.</span
            >
          </div>
        </div>

        <div class="col-sm-12 mb-2">
          <label class="form-label">
            Payment Date <span class="text-danger">*</span>
          </label>
          <input
            type="date"
            formControlName="paymentDate"
            class="form-control"
            max="{{ SetDate }}"
          />
          <div
            *ngIf="
              fDeposit['paymentDate'].touched && fDeposit['paymentDate'].errors
            "
          >
            <span
              *ngIf="fDeposit['paymentDate'].errors['required']"
              class="text-danger"
              >Payment Date is required.</span
            >
          </div>
        </div>
      </div>
    </div>
    <div class="d-flex card-footer justify-content-between">
      <div></div>
      <div>
        <button
          type="button"
          class="btn btn-outline-danger ms-1"
          (click)="modal.dismiss('Cross click')"
        >
          Close
        </button>
        <button type="submit" class="btn btn-success ms-2">submit</button>
      </div>
    </div>
  </form>
</ng-template>

<ng-template #LinkInquiry let-modal>
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">Link Inquiry</h4>
    <button
      type="button"
      class="close btn"
      aria-label="Close"
      (click)="modal.dismiss()"
    >
      <span aria-hidden="true">
        <h3>×</h3>
      </span>
    </button>
  </div>
  <form [formGroup]="LinkInquiryForm" (ngSubmit)="LinkInquiryToApplication()">
    <div class="modal-body">
      <div class="mt-2 mb-2">
        <input type="hidden" formControlName="applicationId" />
        <input type="hidden" formControlName="link" />
        <div class="col-sm-12 mb-2">
          <label class="form-label"
            >Inquiry <span class="text-danger">*</span>
          </label>
          <ng-select
            bindLabel="firstName"
            bindValue="inquiryId"
            [items]="Inquiries"
            [searchable]="true"
            [(ngModel)]="matchedInquiry"
            placeholder="Please select inquiry"
            [clearable]="false"
            style="width: 90% !important"
            formControlName="inquiryId"
          >
          </ng-select>
          <div *ngIf="fl['inquiryId'].touched && fl['inquiryId'].errors">
            <span *ngIf="fl['inquiryId'].errors['required']" class="text-danger"
              >Please select inquiry.</span
            >
          </div>
        </div>
      </div>
    </div>
    <div class="d-flex card-footer justify-content-between">
      <div></div>
      <div>
        <button
          type="button"
          class="btn btn-outline-danger ms-1"
          (click)="modal.dismiss('Cross click')"
        >
          Close
        </button>
        <input type="submit" class="btn btn-success ms-2" value="Link" />
      </div>
    </div>
  </form>
</ng-template>

<ng-template #Visaoffermodel let-modal>
  <div class="modal-content" style="width: 700px">
    <div class="modal-header">
      <h4 class="modal-title" id="modal-basic-title">Visa</h4>
      <button
        type="button"
        class="close btn"
        aria-label="Close"
        (click)="modal.dismiss()"
      >
        <span aria-hidden="true">
          <h3>×</h3>
        </span>
      </button>
    </div>
    <!-- <div *ngIf="userType =='1' && (CasIssueData.length ==0 || IsExpire || isCASWithrow) && IsVisa"> -->
    <form [formGroup]="CsaIssueFileForm" (ngSubmit)="UploadCsaFile()">
      <div class="row mt-4 mx-0 mb-4">
        <div class="col-md-4">
          <label class="mb-2">CAS Reference Number</label>
          <input
            type="text"
            formControlName="CasNumber"
            class="form-control"
            placeholder="i.e. E4G0AE1H42SOJ4"
            maxlength="14"
          />
          <div *ngIf="f['CasNumber'].errors">
            <span
              *ngIf="isSubmitted && f['CasNumber'].errors['required']"
              class="text-danger"
              >Please enter CAS number.</span
            >
            <span *ngIf="f['CasNumber'].errors['pattern']" class="text-danger"
              >Please enter 14 character for CAS number
            </span>
          </div>
        </div>

        <div class="col-md-4 mb-4">
          <div class="form-group">
            <label class="mb-2">CAS Certificate</label>
            <input
              type="file"
              formControlName="FileName"
              class="form-control mb-2"
              (change)="changeCsafile($event)"
            />
            <div *ngIf="!isValidFile">
              <span class="text-danger">Please choose valid file type.</span>
            </div>
            <div *ngIf="isFormSubmitted && f['FileName'].errors">
              <span *ngIf="f['FileName'].errors['required']" class="text-danger"
                >Please chose file</span
              >
            </div>
          </div>
        </div>

        <div class="col-md-4 mb-4">
          <label class="mb-2">CAS Issue Date</label>
          <input
            type="date"
            formControlName="IssueDate"
            class="form-control"
            max="{{ SetDate }}"
          />
          <div *ngIf="isSubmitted && f['IssueDate'].errors">
            <span *ngIf="f['IssueDate'].errors['required']" class="text-danger"
              >Please select IssueDate</span
            >
          </div>
        </div>
        <div class="card-footer text-end">
          <div>
            <button
              class="btn-transition btn btn-outline-danger me-2"
              (click)="modal.dismiss()"
              type="button"
            >
              Cancel
            </button>
            <button
              class="btn-transition btn btn-outline-primary me-2"
              (click)="modal.dismiss()"
              type="button"
            >
              I will do that later
            </button>
            <button class="btn btn-success m-2" *ngIf="!IsExpire" type="submit">
              Issue
            </button>
            <button *ngIf="IsExpire" class="btn btn-success m-2" type="submit">
              Reissue
            </button>
          </div>
        </div>
      </div>
    </form>
    <!-- </div> -->
  </div>
</ng-template>

<ng-template #ApplicationArchievedStatus let-modal>
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">
      Application Status Change
    </h4>
    <button
      type="button"
      class="close btn"
      aria-label="Close"
      (click)="modal.dismiss()"
    >
      <span aria-hidden="true">×</span>
    </button>
  </div>

  <div class="card-body">
    <div class="row">
      <form [formGroup]="applicationArchivedStatusForm">
        <div class="col-md-12 mb-3">
          <label class="form-label"
            >Reason <span class="text-danger">*</span></label
          >
          <input
            type="text"
            class="form-control"
            placeholder="Reason"
            formControlName="comment"
          />
          <div
            *ngIf="
              freasonvalidation['comment'].touched ||
              (freasonvalidation['comment'].errors && IsSave)
            "
          >
            <span
              *ngIf="freasonvalidation['comment'].errors['required']"
              class="text-danger"
              >Reason is required.</span
            >
          </div>
        </div>
      </form>
    </div>
  </div>
  <div class="card-footer">
    <div class="row">
      <div class="col-md-12 text-end">
        <button
          type="button"
          class="btn btn-success"
          [disabled]="!applicationStatusForm.valid"
          (click)="ArchievedApplication()"
        >
        <!-- [disabled]="applicationStatusForm.valid" -->
          Submit
        </button>
      </div>
    </div>
  </div>
</ng-template>
